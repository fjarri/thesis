% =============================================================================
\chapter{Wirtinger calculus}
\label{cha:appendix:c-numbers}
% =============================================================================

Formally, a function of complex variable has to be holomorphic in order to be complex differentiable.
In many cases, however, it is enough to have less strict ``physicists'\,'' complex differentiation rules, which only require the function's real and complex part to be differentiable, without imposing additional constraints.
Such rules were developed by Wirtinger~\cite{Wirtinger1927}; further extension to vectors and matrices was performed by Hj{\o}rungnes and Gesbert~\cite{Hjorungnes2007}.
A very good review and a thorough description of their application was made by Kreutz-Delgado~\cite{Kreutz-Delgado2009}.
This section will outline Wirtinger differentiation rules and provide some lemmas based on them, which, in turn, are going to be used in the further Appendices, and in the main body of the thesis.


% =============================================================================
\section{Differentiation}
% =============================================================================

We will start from the definition of the differentiation:

\begin{definition}
\label{def:c-numbers:wirtinger}
	For a complex variable $z \equiv x + iy$, and a function $f(z) \equiv u(x, y) + iv(x, y)$
	\begin{eqn*}
		\frac{\cwd f(z)}{\cwd z}
		\equiv \frac{1}{2} \left(
			\frac{\upd f}{\upd x} - i \frac{\upd f}{\upd y}
		\right).
	\end{eqn*}
\end{definition}

One can easily check that if $f(z)$ is holomorphic, this definition is equivalent to the standard complex differentiation.
Wirtinger differentiation is quite intuitive in the sense that it obeys all the basic rules associated with a real-valued differentiation:

\begin{theorem}
\label{thm:c-numbers:diff-properties}
	For any $f(z)$ with differentiable real and complex parts, Wirtinger differentiation obeys sum, product, quotient, and chain differentiation rules.
	The latter one is applied as if the function $f(z)$ had two independent arguments $z$ and $z^*$:
	\begin{eqn*}
		\frac{\cwd f(g(z))}{\cwd z}
		= \frac{\cwd f}{\cwd g} \frac{\cwd g}{\cwd z}
			+ \frac{\cwd f}{\cwd g^*} \frac{\cwd g^*}{\cwd z}.
	\end{eqn*}
\end{theorem}

Some important functions we will encounter in this thesis are not holomorphic.
Therefore, hereinafter we will use Wirtinger differentiation unless explicitly stated otherwise,
along with the notation $\cwd f/\cwd z$.
Consequently, by ``differentiability'' we will mean the property used in the above theorem, namely the existence of partial derivatives of $\Real f$ and $\Imag f$ over real and complex axes.

It is convenient to connect symbolic rules for Wirtinger differentiation with the rules for common real-valued differentiation.

\begin{theorem}
\label{thm:c-numbers:independent-vars}
	If a function $f(z)$ can be expanded into the series of $z^n (z^*)^m$, then $\cwd f/\cwd z$ and $\cwd f/\cwd z^*$ can be calculated as partial derivatives of the function $f$ expressed in terms of $z$ and $z^*$, over $z$ and $z^*$ respectively:
	\begin{eqn*}
		\frac{\cwd f(z)}{\cwd z} = \frac{\upd f(z, z^*)}{\upd z},
		\quad
		\frac{\cwd f(z)}{\cwd z^*} = \frac{\upd f(z, z^*)}{\upd z^*}.
	\end{eqn*}
\end{theorem}
\begin{proof}
We will prove the first identity.
Without loss of generality, we can consider $f(z) = z^r (z^*)^s$.
First, one can easily prove (by the transition to real values) that $\cwd (z z^*)/\cwd z = z^*$ and $\cwd (z z^*)/\cwd z^* = z$.
Let us assume that the identity is correct for some $r$ and $s$; then, using the product rule,
\begin{eqn}
	\frac{\cwd}{\cwd z} (z^{r+1} (z^*)^s)
	& = \frac{\cwd}{\cwd z} (z z^r (z^*)^s)
		= z^r (z^*)^s + z \frac{\cwd}{\cwd z} (z^r (z^*)^s) \\
	& = z^r (z^*)^s + r z z^{r-1} (z^*)^s
		= (r + 1) z^r (z^*)^s.
\end{eqn}
By induction, the statement is correct for any natural $r$ and $s$, and it is obviously true if $r = 0$ or $s = 0$, which proves the theorem.
\end{proof}

The chain differentiation rule in \thmref{c-numbers:diff-properties} and the above theorem give rise to the common notation used in conjunction with Wirtinger differentiation.
In order to emphasize the ``independent'' behavior of $z$ and $z^*$, function arguments are sometimes written as $f(z, z^*)$, even though technically they are not independent.
We will not use such notation in this thesis because it will create a lot of clutter later on.


% =============================================================================
\section{Integration}
% =============================================================================

Wirtinger differentiation can be paired with the somewhat more common integration over the complex plane:

\begin{definition}
\label{def:c-numbers:integration}
	For a complex $z = x + iy$
	\begin{eqn*}
		\int \upd^2 z \equiv \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \upd x\, \upd y.
	\end{eqn*}
\end{definition}

This definition allows us to prove an analogue of one of the properties of the Fourier transform expressed in terms of Wirtinger differentiation:

\begin{lemma}
\label{lmm:c-numbers:fourier-of-moments}
	For a complex $\beta$ and any non-negative integers $r$ and $s$
	\begin{eqn*}
		\int \upd^2\alpha\, \alpha^r (\alpha^*)^s \exp(-\beta \alpha^* + \beta^* \alpha)
		= \pi^2
			\left( -\frac{\cwd}{\cwd \beta^*} \right)^r
			\left( \frac{\cwd}{\cwd \beta} \right)^s
			\delta(\Real \beta) \delta(\Imag \beta).
	\end{eqn*}
\end{lemma}
\begin{proof}
First, by changing a variable in the integral and using known Fourier transform relations, we can prove that for real $x$ and $v$, and non-negative integer $n$
\begin{eqn}
\label{eqn:c-numbers:fourier-real}
	\int\limits_{-\infty}^{\infty} \upd v\, v^n \exp(\pm 2 i x v)
	= \pi (\mp i / 2)^n \delta^{(n)}(x).
\end{eqn}
Note that we have explicitly written integration limits here; they are swapped when we change the variable in the first integral.

Denoting $\alpha = u + iv$ and $\beta = x + iy$, we can expand the initial expression as
\begin{eqn2}
	& \int && \upd^2\alpha\, \alpha^r (\alpha^*)^s \exp(-\beta \alpha^* + \beta^* \alpha) \\
	& ={} && \int \upd u\, \upd v\, \exp(2ivx - 2iuy) \\
	& && \times \sum_{m=0}^r \binom{r}{m} u^m (iv)^{r-m}
		\sum_{n=0}^s \binom{s}{n} u^n (-iv)^{s-n} \\
	& ={} && \sum_{m=0}^r \sum_{n=0}^s \binom{r}{m} \binom{s}{n}
		i^{r-m} (-i)^{s-n} \\
	& && \times \int \upd u\, u^{m+n} \exp(2ivx)
		\int \upd v\, v^{r-m+s-n} \exp(-2iuy).
\end{eqn2}
Applying~\eqnref{c-numbers:fourier-real} and grouping differentials:
\begin{eqn}
	={} & \pi^2 \sum_{m=0}^r \sum_{n=0}^s \binom{r}{m} \binom{s}{n} \\
	& \times i^{r-m} (-i)^{s-n}
		(-i/2)^{m+n} \delta^{(m+n)}(y)
		(i/2)^{r-m+s-n} \delta^{(r-m+s-n)}(x) \\
	={} & \pi^2
		\sum_{m=0}^r \binom{r}{m}
			\frac{1}{2^r}
			(-i \upd / \upd y)^m
			(-\upd / \upd x)^{r-m} \\
	& \times \sum_{n=0}^s \binom{s}{n}
			\frac{1}{2^s}
			(-i \upd / \upd y)^n
			(\upd / \upd x)^{s-n}
		\delta(y) \delta(x).
\end{eqn}
Collapsing sums and recognising \defref{c-numbers:wirtinger}:
\begin{eqn}
	& = \pi^2
		\left( \frac{1}{2} (-i \upd / \upd y - \upd / \upd x) \right)^r
		\left( \frac{1}{2} (-i \upd / \upd y + \upd / \upd x) \right)^s
		\delta(y) \delta(x) \\
	& = \pi^2
		\left( -\frac{\cwd}{\cwd \beta^*} \right)^r
		\left( \frac{\cwd}{\cwd \beta} \right)^s
		\delta(\Real \beta) \delta(\Imag \beta).
		\qedhere
\end{eqn}
\end{proof}

It can be proved by expansion in real variables that the formally written rule of integration by parts works for the integral from \defref{c-numbers:integration}:
\begin{eqn}
	\int \upd z\, f \frac{\cwd g}{\cwd z}
	= \int \upd z \frac{\cwd (fg)}{\cwd z} - \int \upd z \frac{\cwd f}{\cwd z} g.
\end{eqn}
Integration by parts will be used extensively in further proofs, and we will need two lemmas that will handle the first term in the right part of the above expression.

\begin{lemma}
\label{lmm:c-numbers:zero-integrals}
	For a square-integrable $f(\beta)$, and a complex $\alpha$
	\begin{eqn*}
		\int \upd^2\beta
			\frac{\cwd}{\cwd \beta} \left(
				\exp(-\beta \alpha^* + \beta^* \alpha)
				f(\beta)
			\right)
		& = 0, \\
		\int \upd^2\beta
			\frac{\cwd}{\cwd \beta^*}
			\left(
				\exp(-\beta \alpha^* + \beta^* \alpha)
				f(\beta)
			\right)
		& = 0.
	\end{eqn*}
\end{lemma}
\begin{proof}
It follows from the square-integrability of $f$ that $\lim_{\Real \beta \rightarrow \infty} = 0$ and $\lim_{\Imag \beta \rightarrow \infty} = 0$, so the statement of the lemma can be proved by transforming to real variables and integrating.
\end{proof}

\begin{lemma}
\label{lmm:c-numbers:zero-delta-integrals}
	For a bounded $f(z)$
	\begin{eqn*}
		\int \upd^2 z
			\frac{\cwd}{\cwd z} \left(
				f(z)
				\left( \frac{\cwd}{\cwd z} \right)^s
				\left( -\frac{\cwd}{\cwd z^*} \right)^r
				\delta(\Real z) \delta(\Imag z)
			\right)
		& = 0, \\
		\int \upd^2 z
			\frac{\cwd}{\cwd z^*}
			\left(
				f(z)
				\left( \frac{\cwd}{\cwd z} \right)^s
				\left( -\frac{\cwd}{\cwd z^*} \right)^r
				\delta(\Real z) \delta(\Imag z)
			\right)
		& = 0.
	\end{eqn*}
\end{lemma}
\begin{proof}
Proved straightforwardly by expanding integrals in real values, separating variables and integrating, using the fact that any derivative of the delta function is zero on the infinity.
\end{proof}
