% =============================================================================
\section{Initial states}
% =============================================================================

\subsection{Coherent state}

The simplest case of initial state is a coherent state.

\begin{theorem}
	The Wigner distribution for a multimode coherent state with with expectation values
	$\alpha_{\nvec}(0) = \alpha_{\nvec}^{(0)}$, $\nvec \in \restbasis$ is
	\begin{eqn*}
		W_{\mathrm{coh}} (\balpha^{(0)})
		= \left( \frac{2}{\pi} \right)^{|\restbasis|} \prod_{\nvec \in \restbasis}
			\exp(-2 |\alpha_{\nvec} - \alpha_{\nvec}^{(0)}|^2).
	\end{eqn*}
\end{theorem}
\begin{proof}
The density matrix of the state is
\begin{eqn}
	\hat{\rho}
	= \vert \alpha_{\nvec}^{(0)},\, \nvec \in \restbasis \rangle
		\langle \alpha_{\nvec}^{(0)},\, \nvec \in \restbasis \vert
	= \left( \prod_{\nvec \in \restbasis} \vert \alpha_{\nvec}^{(0)} \rangle \right)
		\left( \prod_{\nvec \in \restbasis} \langle \alpha_{\nvec}^{(0)} \vert \right).
\end{eqn}
Then the characteristic function is
\begin{eqn}
	\chi_W (\balpha^{(0)})
	& = \Trace{
		\left( \prod_{\nvec \in \restbasis} \vert \alpha_{\nvec}^{(0)} \rangle \right)
		\left( \prod_{\nvec \in \restbasis} \langle \alpha_{\nvec}^{(0)} \vert \right)
		\left( \prod_{\nvec \in \restbasis} \hat{D}_{\nvec} (\lambda_{\nvec}, \lambda_{\nvec}^*) \right)
	} \\
	& = \Trace{
		\left( \prod_{\nvec \in \restbasis} \langle \alpha_{\nvec}^{(0)} \vert \right)
		\left( \prod_{\nvec \in \restbasis} \hat{D}_{\nvec} (\lambda_{\nvec}, \lambda_{\nvec}^*) \right)
		\left( \prod_{\nvec \in \restbasis} \vert \alpha_{\nvec}^{(0)} \rangle \right)
	} \\
	& = \prod_{\nvec \in \restbasis}
		\langle \alpha_{\nvec}^{(0)} \vert
		\hat{D}_{\nvec} (\lambda_{\nvec}, \lambda_{\nvec}^*)
		\vert \alpha_{\nvec}^{(0)} \rangle
\end{eqn}
Displacement operators obey multiplication law \todo{proof needed? taken from Cahill and Glauber}
\begin{eqn}
	\hat{D}(\lambda, \lambda^*) \hat{D}(\alpha, \alpha^*)
	= \hat{D}(\lambda + \alpha, \lambda^* + \alpha^*)
		\exp(\frac{1}{2} (\lambda \alpha^* - \lambda^* \alpha)),
\end{eqn}
and the scalar product of two coherent state is calculated as \todo{again, taken from Cahill and Glauber}
\begin{eqn}
	\langle \beta \vert \alpha \rangle
	= \exp(-\frac{1}{2} |\alpha|^2 - \frac{1}{2} |\beta|^2 + \beta^* \alpha).
\end{eqn}
Therefore
\begin{eqn}
	\hat{D}(\lambda, \lambda^*) \vert \alpha \rangle
	& = \hat{D}(\lambda, \lambda^*) \hat{D}(\alpha, \alpha^*) \vert 0 \rangle
	= \hat{D}(\lambda + \alpha, \lambda^* + \alpha^*)
		\exp(\frac{1}{2} (\lambda \alpha^* - \lambda^* \alpha))
		\vert 0 \rangle \\
	& = \exp(\frac{1}{2} (\lambda \alpha^* - \lambda^* \alpha))
		\vert \lambda + \alpha \rangle,
\end{eqn}
and the characteristic function can be simplified as:
\begin{equation*}
\begin{split}
	\chi_W (\balpha^{(0)})
	& = \prod_{\nvec \in \restbasis}
		\exp(\frac{1}{2} (\lambda_{\nvec} (\alpha_{\nvec}^{(0)})^*
			- \lambda_{\nvec}^* \alpha_{\nvec}^{(0)}))
		\langle \alpha_{\nvec}^{(0)} \vert \lambda_{\nvec} + \alpha_{\nvec}^{(0)} \rangle \\
	& = \prod_{\nvec \in \restbasis}
		\exp(
			- \lambda_{\nvec}^* \alpha_{\nvec}^{(0)}
			+ \lambda_{\nvec} (\alpha_{\nvec}^{(0)})^*
			- \frac{1}{2} |\lambda|^2
		).
\end{split}
\end{equation*}

Finally, Wigner function is
\begin{equation*}
\begin{split}
	W_c (\balpha^{(0)})
	& = \frac{1}{\pi^{2|\restbasis|}} \int d^2\blambda
		\left( \prod_{\nvec \in \restbasis} \exp(
			- \lambda_{\nvec} \alpha_{\nvec}^*
			+ \lambda_{\nvec}^* \alpha_{\nvec}
		) \right)
		\left( \prod_{\nvec \in \restbasis} \exp(
			- \lambda_{\nvec}^* \alpha_{\nvec}^{(0)}
			+ \lambda_{\nvec} (\alpha_{\nvec}^{(0)})^*
			- \frac{1}{2} |\lambda|^2
		) \right) \\
	& = \frac{1}{\pi^{2|\restbasis|}} \prod_{\nvec \in \restbasis} \left(
		\int d^2\lambda_{\nvec}
			\exp(
				- \lambda_{\nvec} (\alpha_{\nvec}^* - (\alpha_{\nvec}^{(0)})^*)
				+ \lambda_{\nvec}^* (\alpha_{\nvec} - \alpha_{\nvec}^{(0)})
				- \frac{1}{2} |\lambda|^2
			)
	\right) \\
	& = \frac{1}{\pi^{2|\restbasis|}} \prod_{\nvec \in \restbasis}
		2 \pi \exp(-2 |\alpha_{\nvec} - \alpha_{\nvec}^{(0)}|^2) \\
	& = \left( \frac{2}{\pi} \right)^{|\restbasis|} \prod_{\nvec \in \restbasis}
		\exp(-2 |\alpha_{\nvec} - \alpha_{\nvec}^{(0)}|^2).
	\qedhere
\end{split}
\end{equation*}
\end{proof}

The resulting Wigner distribution is a product of independent complex-valued Gaussian distributions for each mode,
with the expectation value equal to the expectation value of the mode,
and the variance equal to $\frac{1}{2}$.
Therefore the initial state can be sampled as
\begin{eqn}
	\alpha_{\nvec} = \alpha_{\nvec}^{(0)} + \frac{1}{\sqrt{2}} \eta_{\nvec},
\end{eqn}
where $\eta_{\nvec}$ are normally distributed complex random numbers with zero mean,
$\langle \eta_{\mvec} \eta_{\nvec} \rangle = 0$ and
$\langle \eta_{\mvec} \eta_{\nvec}^* \rangle = \delta_{\mvec,\nvec}$
(in other words, with components distributed independently with variance $\frac{1}{2}$).
This looks like adding half a ``vacuum particle'' to each mode.
In functional form this can be written as
\begin{eqn}
	\Psi_j(\xvec, 0)
	= \Psi_j^{(0)}(\xvec, 0)
		+ \sum_{\nvec \in \restbasis} \frac{\eta_{j,\nvec}}{\sqrt{2}} \phi_{\nvec}(\xvec),
\end{eqn}
where $\Psi_j^{(0)}(\xvec, 0)$ is the ``classical'' ground state of the system.
