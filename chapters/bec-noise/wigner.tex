% =============================================================================
\section{Quasiprobability approach}
\label{sec:bec-noise:wigner}
% =============================================================================

Having discussed the classical mean-field approach in the previous section, we will now apply the functional truncated Wigner method described in \charef{wigner-bec}.
While the mean-field approximation gives a fast way to get a qualitative picture of the \abbrev{bec} dynamics, it ignores many important effects that originate from the inherent quantum nature of the system, in particular nonlinear quantum noise effects of quantum dynamics: phase diffusion, entanglement and quantum squeezing.
The initial noise terms do not occur in the semi-classical Gross-Pitaevskii approximation, which is therefore unable to predict these effects.

We will see how the initial master equation produces \abbrev{cgpe}s very similar to~\eqnref{bec-noise:mean-field:cgpes-simplified} with the loss terms similar to~\eqnref{bec-noise:mean-field:losses}.

Since we assume that the \abbrev{bec} has $s$-wave interactions, we can use the effective Hamiltonian~\eqnref{wigner-bec:hamiltonian:effective-H} expressed using quantum field creation and annihilation operators $\Psiop_j^{\dagger}(\xvec)$ and $\Psiop_j(\xvec)$:
\begin{eqn}
\label{eqn:bec-noise:wigner:master-eqn}
    \hat{H} = \int \upd \xvec \sum_{j=1}^2 \sum_{k=1}^2 \left\{
        \Psiop_j^{\dagger} K_{jk} \Psiop_k
        + \frac{g_{jk}}{2} \Psiop_j^\dagger \Psiop_k^\dagger \Psiop_j \Psiop_k
    \right\},
\end{eqn}
where $g_{jk}$ are nonlinear interaction coefficients~\eqnref{bec-noise:system:g}.
The single-particle Hamiltonian $K_{jk}$ includes the electromagnetic coupling terms, added by analogy with \abbrev{cgpe}s~\eqnref{bec-noise:mean-field:cgpes-simplified}:
\begin{eqn}
\label{eqn:bec-noise:wigner:single-particle-H}
    K_{jk}
    = \left(
            -\frac{\hbar^2}{2m} \nabla^2 + V_j(\xvec)
        \right) \delta_{jk}
        + \hbar \tilde{\Omega}_{jk}(t).
\end{eqn}
Here, same as in the classical \abbrev{cgpe}s, $V_j(\xvec)$ are external potentials~\eqnref{bec-noise:system:V}, and $\tilde{\Omega}$ is the linear coupling matrix
\begin{eqn}
    \tilde{\Omega}
    = \frac{\hbar \Omega}{2}
        \begin{pmatrix}
            0 & e^{-i (\delta t + \alpha)} \\
            e^{i (\delta t + \alpha)} & 0
        \end{pmatrix}.
\end{eqn}

Taking the nonlinear losses into account, the evolution of the system's density matrix $\hat{\rho}$ is described by the Markovian master equation~\eqnref{wigner-bec:master-eqn:master-eqn}:
\begin{eqn}
    \frac{\upd\hat{\rho}}{\upd t} =
        - \frac{i}{\hbar} \left[ \hat{H}, \hat{\rho} \right]
        + \sum_{\lvec \in L} \kappa_{\lvec} \int \upd \xvec
            \mathcal{L}_{\lvec} \left[ \hat{\rho} \right],
\end{eqn}
where $\mathcal{L}$ are loss operators~\eqnref{wigner-bec:master-eqn:loss-op}, and $L$ is the set of loss processes that are experimentally shown to affect the trapped \Rb{} \abbrev{bec}~\cite{Mertes2007,Egorov2011}:
\begin{itemize}
    \item three-body recombination $\hat{O}_{111}=\Psiop_{1}^3$,
    \item two-body interspecies loss $\hat{O}_{12}=\Psiop_{1}\Psiop_{2}$, and
    \item two-body intraspecies loss $\hat{O}_{22}=\Psiop_{2}^2$,
\end{itemize}
with the coefficients depending on the components used in the particular experiment.

Applying the general formulas from \charef{wigner-bec}, we can transform the master equation~\eqnref{bec-noise:wigner:master-eqn} to a \abbrev{fpe} for the truncated Wigner functional, and further to a set of \abbrev{sde}s in the Stratonovich form~\eqnref{wigner-bec:fpe-bec:sde-stratonovich}:
\begin{eqn}
\label{eqn:bec-noise:wigner:sde}
    \upd\Psi_1 & = \mathcal{P}_{\restbasis_1} \left[
        \mathcal{A}_1^{(s)} \upd t
        + \sum_{\lvec \in L} \mathcal{B}_{1,\lvec} \upd Q_{\lvec}
    \right], \\
    \upd\Psi_2 & = \mathcal{P}_{\restbasis_2} \left[
        \mathcal{A}_2^{(s)} \upd t
        + \sum_{\lvec \in L} \mathcal{B}_{2,\lvec} \upd Q_{\lvec}
    \right].
\end{eqn}
with the drift terms
\begin{eqn}
\label{eqn:bec-noise:wigner:drift}
    \mathcal{A}_1^{(s)}
    ={} & - \frac{i}{\hbar} \left(
            \sum_{k=1}^2 K_{1k} \Psi_k
            + \Psi_1 \sum_{k=1}^2 U_{1k} \left(
                |\Psi_k|^2 - \frac{\delta_{1k} + 1}{2} \delta_{\restbasis_k}(\xvec, \xvec)
            \right)
        \right) \\
    & - 3\kappa_{111} |\Psi_1|^2 |\Psi_1|^2 \Psi_1
        - \kappa_{12} |\Psi_2|^2 \Psi_1, \\
    \mathcal{A}_2^{(s)}
    ={} & - \frac{i}{\hbar} \left(
            \sum_{k=1}^2 K_{2k} \Psi_k
            + \Psi_2 \sum_{k=1}^2 U_{2k} \left(
                |\Psi_{k}|^2 - \frac{\delta_{2k} + 1}{2} \delta_{\restbasis_k}(\xvec, \xvec)
            \right)
        \right) \\
    & - \kappa_{12} |\Psi_1|^2 \Psi_2
    - 2\kappa_{22} |\Psi_2|^2 \Psi_2,
\end{eqn}
and the noise terms
\begin{eqn}
    \mathcal{B}_{1,111} = 3 \sqrt{\kappa_{111}} \left( \Psi_1^* \right)^2,\quad
    \mathcal{B}_{1,12} = \sqrt{\kappa_{12}} \Psi_2^*,\quad
    \mathcal{B}_{1,22} = 0, \\
    \mathcal{B}_{2,111} = 0,\quad
    \mathcal{B}_{2,12} = \sqrt{\kappa_{12}} \Psi_1^*,\quad
    \mathcal{B}_{2,22} = 2\sqrt{\kappa_{22}} \Psi_2^*.
\end{eqn}
Note that the main order of the loss components in the drift terms coincides with the phenomenological loss components of \abbrev{cgpe}s~\eqnref{bec-noise:mean-field:cgpes}.

Note that the drift coefficients~\eqnref{bec-noise:wigner:drift} and \abbrev{cgpe}s~\eqnref{bec-noise:mean-field:cgpes} use different loss coefficients.
This is caused by the fact that the coefficients $\kappa$ originate from the ``natural theoretical'' definition (a coefficient in front of the loss operator $\mathcal{L}$), and the coefficients $\gamma$ correspond to the ``natural experimental'' definition based on the observed atom number losses:
\begin{eqn}
    \frac{\upd n_j}{\upd t} = - \gamma_{j,\lvec} n^{l_1}_1 n^{l_2}_2 \ldots,
\end{eqn}
where $n_j$ is the density of component $j$.
The conversion between these two representations can be carried out easily as $\gamma_{j,\lvec} \equiv 2 l_j \kappa_{\lvec}$.

The pick of an initial state for the integration largely depends on the system in question.
While the expectation of the initial Wigner functional is usually the classical ground state minimizing the energy functional~\eqnref{bec-noise:mean-field:two-comp-energy}, the actual distribution can be different.
For the interferometry experiments described in this thesis it is usually sufficient to assume the initial coherent state which can be sampled as a set of Gaussian random numbers according to \thmref{wigner-bec:initial-state:coherent-state}, since the temperature of the condensate is low.
In more complicated cases when the temperature cannot be neglected, one can use Bogoliubov states~\cite{Blakie2008,Ruostekoski2010}, for which there exists a numerically efficient sampling method~\cite{Sinatra2002}.
The initial Wigner distribution may also include uncertainties of the ground state cause by ``technical'' reasons, for example the by the variation in the trap frequencies.
