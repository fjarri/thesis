% =============================================================================
\section{Single-mode transformation}
% =============================================================================

In this section we will work with a single-mode bosonic system with the standard creation and annihilation operators
\begin{eqn}
	[ \hat{a}, \hat{a} ] & = [ \hat{a}^\dagger, \hat{a}^\dagger ] = 0, \\
	[ \hat{a}, \hat{a}^\dagger ] & = 1.
\end{eqn}
An essential part of the Wigner function definition is the displacement operator.
This was first introduced by Weyl~\cite{Weyl1950} and thoroughly described by Cahill and Glauber~\cite{Cahill1969}:

\begin{definition}
	The displacement operator is the operator-valued function of a complex variable
	\begin{eqn*}
	\label{eqn:mm-wigner:sm:displacement-op}
		\hat{D}(\lambda) = \exp(\lambda \hat{a}^\dagger - \lambda^* \hat{a}).
	\end{eqn*}
\end{definition}

Using the Baker-Hausdorff theorem to split non-commuting creation and annihilation operators in the exponent, one can find that
\begin{eqn}
\label{eqn:mm-wigner:sm:displacement-derivatives}
	\frac{\cwd}{\cwd \lambda} \hat{D}(\lambda)
	& = \hat{D}(\lambda) (\hat{a}^\dagger + \frac{1}{2} \lambda^*)
	= (\hat{a}^\dagger - \frac{1}{2} \lambda^*) \hat{D}(\lambda), \\
	-\frac{\cwd}{\cwd \lambda^*} \hat{D}(\lambda)
	& = \hat{D}(\lambda) (\hat{a} + \frac{1}{2} \lambda)
	= (\hat{a} - \frac{1}{2} \lambda) \hat{D}(\lambda).
\end{eqn}

Using the displacement operator we can define the Wigner transformation:

\begin{definition}
\label{def:mm-wigner:sm:w-transformation}
	The Wigner transformation converts an operator $\hat{A}$ on a Hilbert space to a complex-valued function $\mathcal{W}[\hat{A}](\alpha)$ on phase space:
	\begin{eqn*}
		\mathcal{W}\left[\hat{A}\right]
		= \frac{1}{\pi^2} \int \upd^2 \lambda \exp(-\lambda \alpha^* + \lambda^* \alpha)
			\Trace{ \hat{A} \hat{D}(\lambda) }.
	\end{eqn*}
	The backward transformation (called the Weyl transformation) restores the operator:
	\begin{eqn*}
		\mathcal{W}^{-1}[f]
		= \frac{1}{\pi} \int \upd^2 \xi \hat{D}^{\dagger}(\xi)
			\int \upd^2 \eta \exp(-\eta \xi^* + \eta^* \xi) f(\eta).
	\end{eqn*}
\end{definition}

It is easy to demonstrate that Wigner and Weyl transformations define a bijection $\mathbb{H} \leftrightarrow (\mathbb{C} \rightarrow \mathbb{C})$ for Hilbert-Schmidt operators and square-integrable functions.
Let us assume $\hat{A} \equiv \mathcal{W}^{-1}[f]$.
Then, using the fact that $\Trace{\hat{D}^{\dagger}(\xi) \hat{D}(\lambda)} = \pi \delta(\Real \xi - \Real \lambda) \delta(\Imag \xi - \Imag \lambda)$~\cite{Cahill1969}:
\begin{eqn}
	\mathcal{W}[\hat{A}]
	={} & \frac{1}{\pi^3} \int \upd^2 \lambda \exp(-\lambda \alpha^* + \lambda^* \alpha) \\
	&	\times \Trace{
			\int \upd^2 \xi \hat{D}^{\dagger}(\xi)
				\int \upd^2 \eta \exp(-\eta \xi^* + \eta^* \xi) f(\eta)
			\hat{D}(\lambda)
		} \\
	={} & \frac{1}{\pi^2} \int \upd^2 \lambda \int \upd^2 \eta
	 	\exp(-\lambda \alpha^* + \lambda^* \alpha)
		\exp(-\eta \lambda^* + \eta^* \lambda) f(\eta).
\end{eqn}
Applying \lmmref{c-numbers:fourier-of-moments} to integrate over $\lambda$:
\begin{eqn}
	\mathcal{W}[\hat{A}]
	& = \frac{1}{\pi^2} \int \upd^2 \eta \int \upd^2 \lambda
	 	\exp(-\lambda (\alpha^* - \eta^*) + \lambda^* (\alpha - \eta)) f(\eta) \\
	& = \int \upd^2 \eta \delta(\Real \alpha - \Real \eta) \delta(\Imag \alpha - \Imag \eta) f(\eta) \\
	& = f(\alpha).
\end{eqn}
The proof for the other direction looks the same.

Although, in general, the result of the Wigner transformation is a complex-valued function, for Hermitian operators, which are of the main interest for us, it can be proved to always be real-valued.

\begin{theorem}
\label{thm:mm-wigner:sm:w-real}
	If an operator $\hat{A}$ is Hermitian, its Wigner transformation $W[\hat{A}]$ is a real-valued function.
\end{theorem}
\begin{proof}
Let us calculate the conjugate of $W[\hat{A}]$:
\begin{eqn}
	(W[\hat{A}])^*
	& = \frac{1}{\pi^2} \int \upd^2 \lambda \exp(-\lambda^* \alpha + \lambda \alpha^*)
		(\Trace{ \hat{A} \exp(\lambda \hat{a}^\dagger - \lambda^* \hat{a}) })^*.
\end{eqn}
Changing variables as $\lambda \rightarrow -\lambda$ and using the fact that $(\Tr{\hat{B}})^* = \Tr{\hat{B}^\dagger}$:
\begin{eqn}
	(W[\hat{A}])^*
	& = \frac{1}{\pi^2} \int \upd^2 \lambda \exp(\lambda^* \alpha - \lambda \alpha^*)
		\Trace{ \hat{A}^\dagger \exp(-\lambda^* \hat{a} + \lambda \hat{a}^\dagger) } \\
	& = W[\hat{A}^\dagger].
\end{eqn}
Therefore, if $\hat{A} = \hat{A}^\dagger$, the conjugate of $W[\hat{A}]$ is equal to itself and, therefore, is real.
\end{proof}

Earlier in this section we have defined the Wigner transformation for arbitrary operators, but the most often occurring and the most important case is the transformation of a density matrix.

\begin{definition}
\label{def:mm-wigner:sm:w-function}
	The Wigner function is the Wigner transformation of a density matrix:
	\begin{eqn*}
		W(\alpha) \equiv \mathcal{W}[\hat{\rho}].
	\end{eqn*}
\end{definition}

The Wigner function always exists for any density matrix~\cite{Gardiner2004}.
Note also that since any density matrix is Hermitian, according to \thmref{mm-wigner:sm:w-real} $W(\alpha)$ is a real-valued function.

In some cases, it will be convenient to use the Wigner function in the form
\begin{eqn}
	W (\alpha)
	= \frac{1}{\pi^2} \int \upd^2 \lambda \exp(-\lambda \alpha^* + \lambda^* \alpha)
		\chi_W (\lambda),
\end{eqn}
where $\chi_W (\lambda)$ is the characteristic function
\begin{eqn}
	\chi_W (\lambda) = \Trace{ \hat{\rho} \hat{D}(\lambda) }.
\end{eqn}

We will finish this section with the proofs of two central theorems which are required for any practical application of the Wigner function.
The first theorem provides a way to transform any master equation written in terms of creation and annihilation operators to a partial differential equation for the Wigner function.

\begin{theorem}[operator correspondences]
\label{thm:mm-wigner:sm:correspondences}
	For any Hilbert-Schmidt operator $\hat{A}$
	\begin{eqn*}
		\mathcal{W} [ \hat{a} \hat{A} ]
			& = \left( \alpha + \frac{1}{2} \frac{\cwd}{\cwd \alpha^*} \right) \mathcal{W}[\hat{A}],
		\quad
		\mathcal{W} [ \hat{a}^\dagger \hat{A} ]
			= \left( \alpha^* - \frac{1}{2} \frac{\cwd}{\cwd \alpha} \right) \mathcal{W}[\hat{A}], \\
		\mathcal{W} [ \hat{A} \hat{a} ]
			& = \left( \alpha - \frac{1}{2} \frac{\cwd}{\cwd \alpha^*} \right) \mathcal{W}[\hat{A}],
		\quad
		\mathcal{W} [ \hat{A} \hat{a}^\dagger ]
			= \left( \alpha^* + \frac{1}{2} \frac{\cwd}{\cwd \alpha} \right) \mathcal{W}[\hat{A}].
	\end{eqn*}
\end{theorem}
\begin{proof}
We will prove the first correspondence.
First, let us transform the trace using~\eqnref{mm-wigner:sm:displacement-derivatives}:
\begin{eqn}
	\Trace{ \hat{a} \hat{A} \hat{D} }
	= \Trace{ \hat{A} \hat{D} \hat{a}}
	= \left(
		-\frac{\cwd}{\cwd \lambda^*}
		-\frac{1}{2} \lambda
	\right) \Trace{ \hat{A} \hat{D}}.
\end{eqn}
Substituting this into the definition of the Wigner transformation:
\begin{eqn}
	\mathcal{W} [ \hat{a} \hat{A} ]
	& = \frac{1}{\pi^2} \int \upd^2 \lambda \exp(-\lambda \alpha^* + \lambda^* \alpha)
		\Trace{ \hat{a} \hat{A} \hat{D}(\lambda) } \\
	& = \frac{1}{\pi^2} \int \upd^2 \lambda \exp(-\lambda \alpha^* + \lambda^* \alpha)
		\left(
			-\frac{\cwd}{\cwd \lambda^*}
			-\frac{1}{2} \lambda
		\right)
		\Trace{ \hat{A} \hat{D}(\lambda) } \\
	& = \frac{1}{2} \frac{\cwd}{\cwd \alpha^*} \mathcal{W} [\hat{A}]
	- \frac{1}{\pi^2} \int \upd^2 \lambda \exp(-\lambda \alpha^* + \lambda^* \alpha)
		\frac{\cwd}{\cwd \lambda^*}
		\Trace{ \hat{A} \hat{D}(\lambda) }.
\end{eqn}
The second term is almost the definition of the Wigner function, except for the derivative over $\lambda^*$.
Here we can use \lmmref{c-numbers:zero-integrals} since $\hat{A}$ is a Hilbert-Schmidt operator, which means that $\Trace{\hat{A} \hat{D}}$ is square-integrable~\cite{Cahill1969}.
This implies that we can use integration by parts with vanishing surface term, so
\begin{eqn}
	\mathcal{W} [ \hat{a} \hat{A} ]
	& = \frac{1}{2} \frac{\cwd}{\cwd \alpha^*} \mathcal{W} [\hat{A}]
	+ \frac{1}{\pi^2} \int \upd^2 \lambda \left(
		\frac{\cwd}{\cwd \lambda^*} \exp(-\lambda \alpha^* + \lambda^* \alpha)
	\right)
	\Trace{ \hat{A} \hat{D}(\lambda) } \\
	& = \left( \alpha + \frac{1}{2} \frac{\cwd}{\cwd \alpha^*} \right) \mathcal{W} [\hat{A}].
	\qedhere
\end{eqn}
\end{proof}

This theorem is paired with the second theorem, which helps to extract observables (again, expressed in terms of creation and annihilation operators) from a known Wigner function.
We will start by proving an auxiliary lemma which connects the expectation of an operator product with a derivative of the characteristic function.

\begin{lemma}
\label{lmm:mm-wigner:sm:moments-from-chi}
	For a system with a density matrix $\hat{\rho}$ and corresponding characteristic function $\chi_W$:
	\begin{eqn*}
		\langle \symprod{ \hat{a}^r (\hat{a}^\dagger)^s } \rangle
		= \left.
			\left( \frac{\cwd}{\cwd \lambda} \right)^s
			\left( -\frac{\cwd}{\cwd \lambda^*} \right)^r
			\chi_W (\lambda)
		\right|_{\lambda=0}.
	\end{eqn*}
\end{lemma}
\begin{proof}
The exponent in the expression for $\chi_W$ can be expanded as
\begin{eqn}
	\exp (\lambda \hat{a}^\dagger - \lambda^* \hat{a})
	= \sum_{j,k}
		\frac{(-\lambda^*)^j \lambda^k}{j!k!}
		\symprod{ \hat{a}^j (\hat{a}^\dagger)^k }.
\end{eqn}
Thus,
\begin{eqn}
	\chi_W(\lambda)
	& = \sum_{j,k}
		\frac{(-\lambda^*)^j \lambda^k}{j!k!}
		\Trace{
			\hat{\rho} \symprod{ \hat{a}^j (\hat{a}^\dagger)^k }
		} \\
	& = \sum_{j,k}
		\frac{(-\lambda^*)^j \lambda^k}{j!k!}
		\langle \symprod{ \hat{a}^j (\hat{a}^\dagger)^k } \rangle.
\end{eqn}
Clearly, the application of $(\cwd / \cwd \lambda)^s$ and $(-\cwd / \cwd \lambda^*)^r$ will eliminate all moments with $j < r$ and $k < s$, and setting $\lambda = 0$ afterwards will eliminate all moments with $j > r$ and $k > s$, leaving only the term with $\symprod{ \hat{a}^r (\hat{a}^\dagger)^s }$:
\begin{eqn}
	\left.
		\left( \frac{\cwd}{\cwd \lambda} \right)^s
		\left( -\frac{\cwd}{\cwd \lambda^*} \right)^r
		\chi_W (\lambda)
	\right|_{\lambda=0}
	& = r! s! \frac{1}{r! s!}
		\langle \symprod{ \hat{a}^r (\hat{a}^\dagger)^s } \rangle \\
	& = \langle \symprod{ \hat{a}^r (\hat{a}^\dagger)^s } \rangle.
	\qedhere
\end{eqn}
\end{proof}

Using this lemma we can now prove the main theorem which connects expectations of observables with moments of the Wigner function.

\begin{theorem}
\label{thm:mm-wigner:sm:moments}
	For a system with a density matrix $\rho$ and a corresponding Wigner function $W(\alpha)$, given any non-negative integers $r$, $s$:
	\begin{eqn*}
		\langle \symprod{ \hat{a}^r (\hat{a}^\dagger)^s } \rangle
		= \int \upd^2\alpha\, \alpha^r (\alpha^*)^s W(\alpha).
	\end{eqn*}
\end{theorem}
\begin{proof}
By definition of the Wigner function:
\begin{eqn}
	\int \upd^2\alpha\, \alpha^r (\alpha^*)^s W(\alpha)
	= \frac{1}{\pi^2}
		\int \upd^2\alpha\, \alpha^r (\alpha^*)^s
		\int \upd^2\lambda \exp(-\lambda \alpha^* + \lambda^* \alpha)
		\chi_W (\lambda).
\end{eqn}
Integrating over $\alpha$ using \lmmref{c-numbers:fourier-of-moments}:
\begin{eqn}
	\int \upd^2\alpha\, \alpha^r (\alpha^*)^s W(\alpha)
	= \int \upd^2\lambda
		\left(
			\left( \frac{\cwd}{\cwd \lambda} \right)^s
			\left( -\frac{\cwd}{\cwd \lambda^*} \right)^r
			\delta(\Real \lambda) \delta(\Imag \lambda)
		\right)
		\chi_W (\lambda).
\end{eqn}
Integrating by parts and eliminating terms which fit \lmmref{c-numbers:zero-delta-integrals}:
\begin{eqn}
	\int \upd^2\alpha\, \alpha^r (\alpha^*)^s W(\alpha)
	& = \int \upd^2\lambda
		\delta(\Real \lambda) \delta(\Imag \lambda)
		\left( \frac{\cwd}{\cwd \lambda} \right)^s
		\left( -\frac{\cwd}{\cwd \lambda^*} \right)^r
		\chi_W (\lambda) \\
	& = \left.
		\left( \frac{\cwd}{\cwd \lambda} \right)^s
		\left( -\frac{\cwd}{\cwd \lambda^*} \right)^r
		\chi_W (\lambda)
	\right|_{\lambda=0}.
\end{eqn}
Now, recognising the final expression as a part of \lmmref{mm-wigner:sm:moments-from-chi}, we immediately get the statement of the theorem.
\end{proof}

With the help of \thmref{mm-wigner:sm:correspondences} and \thmref{mm-wigner:sm:moments} one can straightforwardly transform any master equation written in terms of creation and annihilation operators $\hat{a}^\dagger$ and $\hat{a}$ to an ordinary differential equation, and use its solution to get expectations of any observables.
