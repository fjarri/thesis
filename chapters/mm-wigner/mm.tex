% =============================================================================
\section{Multimode Wigner representation}
% =============================================================================


Single-mode \defref{mm-wigner:sm:w-transformation} of Wigner transformation can be extended to the case of many modes.
Mode operators $\hat{a}_\nvec$, $\nvec \in \restbasis$, obey bosonic commutation relations:
\begin{eqn}
\label{eqn:mm-wigner:mm:commutators}
	[ \hat{a}_{\mvec}, \hat{a}_{\nvec} ]
	& = [ \hat{a}_{\mvec}^\dagger, \hat{a}_{\nvec}^\dagger ] = 0, \\
	[ \hat{a}_{\mvec}, \hat{a}_{\nvec}^\dagger ] & = \delta_{\mvec,\nvec}.
\end{eqn}

\begin{definition}
\label{def:mm-wigner:mm:w-transformation}
	Let $\blambda$ and $\balpha$ be vectors of $\lambda_{\nvec}$ and $\alpha_{\nvec}$ values respectively.
	Multimode Wigner transformation is
	\begin{eqn*}
		\mathcal{W}[\hat{A}]
		= \frac{1}{\pi^{2|\restbasis|}}
			\int \upd^2 \blambda
			\left(
				\prod_{\nvec \in \restbasis} \exp(-\lambda_{\nvec} \alpha_{\nvec}^* + \lambda_{\nvec}^* \alpha_{\nvec})
			\right)
			\Trace{
				\hat{A}
				\prod_{\nvec \in \restbasis} \hat{D}_{\nvec} (\lambda_{\nvec})
			},
	\end{eqn*}
	where $\hat{D}_{\nvec}(\lambda_{\nvec}) = \exp(\lambda_{\nvec} \hat{a}_{\nvec}^\dagger - \lambda_{\nvec}^* \hat{a}_{\nvec})$, $\int \upd^2 \blambda \equiv \int \prod_{\nvec \in \restbasis} \upd \lambda_{\nvec}$ , and $|\restbasis|$ stands for the cardinality of $\restbasis$.
	Multi-component Weyl transformation is, correspondingly,
	\begin{eqn*}
		\mathcal{W}^{-1}[f]
		= \frac{1}{\pi^{|\restbasis|}} \int \upd^2 \bxi
			\left( \prod_{\nvec \in \restbasis} \hat{D}_{\nvec}^{\dagger}(\xi_{\nvec}) \right)
			\int \upd^2 \bfeta
				\left( \prod_{\nvec \in \restbasis}
					\exp(-\eta_{\nvec} \xi_{\nvec}^* + \eta_{\nvec}^* \xi_{\nvec})
				\right) f(\bfeta).
	\end{eqn*}
\end{definition}

It can be proved, same as in \thmref{mm-wigner:sm:w-real} for the single-mode case, that $W[\hat{A}]$ is real if $\hat{A}$ is Hermitian.
The equality $\mathcal{W}[\mathcal{W}^-1[f]] \equiv f$ is proved analogously to the single-mode case as well.

Corresponding definitions of multimode characteristic function and Wigner function are therefore
\begin{eqn}
	\chi_W (\blambda)
	= \Trace{
		\hat{\rho}
		\prod_{\nvec \in \restbasis} \hat{D}_{\nvec} (\lambda_{\nvec})
	},
\end{eqn}
and
\begin{eqn}
	W (\balpha)
	\equiv \mathcal{W}[\hat{\rho}]
	= \frac{1}{\pi^{2|\restbasis|}} \int \upd^2 \blambda
		\left(
			\prod_{\nvec \in \restbasis}
			\exp(-\lambda_{\nvec} \alpha_{\nvec}^* + \lambda_{\nvec}^* \alpha_{\nvec})
		\right)
		\chi_W (\blambda).
\end{eqn}

Following the single-mode scheme, we can formulate two theorems that govern the transformation of a master equation and subsequent calculation of observables.

\begin{theorem}[Multimode extension of \thmref{mm-wigner:sm:correspondences}]
\label{thm:mm-wigner:mm:correspondences}
	For any Hilbert-Schmidt operator $\hat{A}$
	\begin{eqn*}
		\mathcal{W} [ \hat{a}_{\nvec} \hat{A} ]
			& = \left( \alpha_{\nvec} + \frac{1}{2} \frac{\cwd}{\cwd \alpha_{\nvec}^*} \right)
				\mathcal{W}[\hat{A}],
		\quad
		\mathcal{W} [ \hat{a}_{\nvec}^\dagger \hat{A} ]
			= \left( \alpha_{\nvec}^* - \frac{1}{2} \frac{\cwd}{\cwd \alpha_{\nvec}} \right)
				\mathcal{W}[\hat{A}], \\
		\mathcal{W} [ \hat{A} \hat{a}_{\nvec} ]
			& = \left( \alpha_{\nvec} - \frac{1}{2} \frac{\cwd}{\cwd \alpha_{\nvec}^*} \right)
				\mathcal{W}[\hat{A}],
		\quad
		\mathcal{W} [ \hat{A} \hat{a}_{\nvec}^\dagger ]
			= \left( \alpha_{\nvec}^* + \frac{1}{2} \frac{\cwd}{\cwd \alpha_{\nvec}} \right)
				\mathcal{W}[\hat{A}].
	\end{eqn*}
\end{theorem}
\begin{proof}
The procedure is the same as in \thmref{mm-wigner:sm:correspondences}.
\end{proof}

\begin{lemma}[Multimode extension of \lmmref{mm-wigner:sm:moments-from-chi}]
\label{lmm:mm-wigner:mm:moments-from-chi}
	For a system with the density matrix $\rho$ and the corresponding characteristic function $\chi_W$:
	\begin{eqn*}
		\langle \symprod{ \prod_{\nvec \in \restbasis}
			\hat{a}_{\nvec}^{r_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{s_{\nvec}} } \rangle
		= \left.
			\left(
				\prod_{\nvec \in \restbasis}
				\left( \frac{\cwd}{\cwd \lambda_{\nvec}} \right)^{s_{\nvec}}
				\left( -\frac{\cwd}{\cwd \lambda_{\nvec}^*} \right)^{r_{\nvec}}
			\right)
			\chi_W (\blambda)
		\right|_{\blambda=0}.
	\end{eqn*}
\end{lemma}
\begin{proof}
Mode operators with different indices commute, so
\begin{eqn}
	\chi_W (\blambda)
	& = \Trace{
		\hat{\rho}
		\prod_{\nvec \in \restbasis}
			\exp( \lambda_{\nvec} \hat{a}_{\nvec}^\dagger - \lambda_{\nvec}^* \hat{a}_{\nvec})
	} \\
	& = \Trace{
		\hat{\rho}
		\prod_{\nvec \in \restbasis}
			\sum_{j_{\nvec} \in \restbasis, k_{\nvec} \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{j_{\nvec}} \lambda_{\nvec}^{k_{\nvec}}}{j_{\nvec}! k_{\nvec}!}
			\symprod{ \hat{a}_{\nvec}^{j_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{k_{\nvec}}}
	} \\
	& = \Trace{
		\hat{\rho}
		\left( \prod_{\nvec \in \restbasis} \sum_{j_{\nvec}, k_{\nvec}} \right)
		\left(
			\prod_{\nvec \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{j_{\nvec}} \lambda_{\nvec}^{k_{\nvec}}}{j_{\nvec}! k_{\nvec}!}
			\symprod{ \hat{a}_{\nvec}^{j_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{k_{\nvec}}}
		\right)
	},
\end{eqn}
where we have used $\left( \prod_{\nvec \in \restbasis} \sum_{j_{\nvec}, k_{\nvec}} \right)$ in a sense of a sequence of summations $\ldots \sum_{j_{\nvec}, k_{\nvec}} \ldots$ for all values of $\nvec \in \restbasis$.
Separating operator and scalar parts:
\begin{eqn}
	& = \Trace{
		\left( \prod_{\nvec \in \restbasis} \sum_{j_{\nvec}, k_{\nvec}} \right)
		\left(
			\prod_{\nvec \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{j_{\nvec}} \lambda_{\nvec}^{k_{\nvec}}}{j_{\nvec}! k_{\nvec}!}
		\right)
		\hat{\rho}
		\symprod{ \prod_{\nvec \in \restbasis} \hat{a}_{\nvec}^{j_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{k_{\nvec}}}
	} \\
	& = \left( \prod_{\nvec \in \restbasis} \sum_{j_{\nvec}, k_{\nvec}} \right)
		\left(
			\prod_{\nvec \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{j_{\nvec}} \lambda_{\nvec}^{k_{\nvec}}}{j_{\nvec}! k_{\nvec}!}
		\right)
		\langle
			\symprod{ \prod_{\nvec \in \restbasis} \hat{a}_{\nvec}^{j_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{k_{\nvec}}}
		\rangle.
\end{eqn}
Same as in \lmmref{mm-wigner:sm:moments-from-chi}, differentiating the resulting expression and setting $\blambda = 0$ will leave only term with required $j_{\nvec} = r_{\nvec}$ and $k_{\nvec} = s_{\nvec}$.
\end{proof}

Moments of multimode Wigner function correspond to the averages of symmetrically ordered products in the same way as for the single-mode case.

\begin{theorem}[Multimode extension of \thmref{mm-wigner:sm:moments}]
\label{thm:mm-wigner:mm:moments}
	For a system with the density matrix $\rho$ and the corresponding Wigner function $W(\balpha)$, and any non-negative integer $r$, $s$:
	\begin{eqn*}
		\langle \symprod{
			\prod_{\nvec \in \restbasis}
			\hat{a}_{\nvec}^{r_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{s_{\nvec}}
		} \rangle
		= \int \upd^2 \balpha
			\left(
				\prod_{\nvec \in \restbasis} \alpha_{\nvec}^{r_{\nvec}} (\alpha_{\nvec}^*)^{s_{\nvec}}
			\right) W(\balpha).
	\end{eqn*}
\end{theorem}
\begin{proof}
The proof is carried out similarly to \thmref{mm-wigner:sm:moments}: integrals over $\alpha_{\nvec}$ are eliminated one by one using \lmmref{c-numbers:fourier-of-moments}, resulting integrals over $\lambda_{\nvec}$ are dealt with using integration by parts and \lmmref{c-numbers:zero-delta-integrals}, until we get the right part of \lmmref{mm-wigner:mm:moments-from-chi}.
\end{proof}
