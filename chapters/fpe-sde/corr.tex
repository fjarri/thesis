% =============================================================================
\section{Correspondences}
% =============================================================================

We will start by formulating the known real-valued correspondence in a form which is more convenient for further proofs in this section, and also close to the results one obtains from the Wigner transformation.

\begin{lemma}[real-valued \abbrev{fpe}--\abbrev{sde}s correspondence in convenient form.]
\label{lmm:fpe-sde:corr:fpe-sde-real}
	If $\zvec^T \equiv (z_1 \ldots z_M)$ is a set of real variables, a \abbrev{fpe}
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		= -\vcwd_{\zvec}^T \cdot \avec W
		+ \frac{1}{2} \Trace{ \vcwd_{\zvec} \vcwd_{\zvec}^T B B^T } W
	\end{eqn*}
	is equivalent to a the set of \abbrev{sde}s in It\^{o} form
	\begin{eqn*}
		\upd\zvec = \avec \upd t + B \upd\Zvec
	\end{eqn*}
	and to a set of \abbrev{sde}s in Stratonovich form
	\begin{eqn*}
		\upd\zvec = (\avec - \svec)\upd t + B \upd\Zvec,
	\end{eqn*}
	where the noise-induced (Stratonovich) drift vector $\svec$ has elements
	\begin{eqn*}
		s_j
		= \frac{1}{2} \sum_{k,i} B_{ki} \frac{\cwd}{\cwd z_k} B_{ji}
		= \frac{1}{2} \Trace{B^T \vcwd_{\zvec} \evec_j^T B},
	\end{eqn*}
	$\evec_i$ being the unit vector with elements $(\evec_j)_i = \delta_{ij}$.
	Here $W \equiv W(\zvec)$ is a probability distribution, $\avec \equiv \avec(\zvec)$ is a vector function, $B \equiv B(\zvec)$ is a matrix function ($B$ having size $M \times L$, where $L$ corresponds to the number of noise sources), $\vcwd_{\zvec}^T \equiv (\upd/\upd z_1 \ldots \upd/\upd z_M)$ is a cogradient vector, and $\Zvec$ is a standard $L$-dimensional Wiener process with $\langle \upd Z_j^2 \rangle = \upd t$.
\end{lemma}
\begin{proof}
For detailed proof see~\cite{Risken1996}, sections 3.3 and 3.4.
\end{proof}

The above theorem can be extended to work with complex Wirtinger derivatives and complex-valued coefficients.
Of couse, in order to produce the real-valued $\upd W/\upd t$ in the left part, a \abbrev{fpe} must have a particular form.

\begin{theorem}
\label{thm:fpe-sde:corr:fpe-sde-complex}
	If $\balpha^T \equiv (\alpha_1 \ldots \alpha_M)$ is a set of complex variables, a \abbrev{fpe}
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		= -\vcwd_{\balpha}^T \avec W - \vcwd_{\balpha^*}^T \avec^* W
		+ \Trace{ \vcwd_{\balpha^*} \vcwd_{\balpha}^T B B^H } W
	\end{eqn*}
	is equivalent to a set of \abbrev{sde}s in It\^{o} form
	\begin{eqn*}
		\upd\balpha = \avec \upd t + B \upd\Zvec,
	\end{eqn*}
	and to a set of \abbrev{sde}s in Stratonovich form
	\begin{eqn*}
		\upd\balpha = (\avec - \svec) \upd t + B \upd\Zvec,
	\end{eqn*}
	where the Stratonovich term has elements
	\begin{eqn*}
		s_j = \frac{1}{2} \Trace{ B^H \vcwd_{\balpha^*} \evec_j^T B },
	\end{eqn*}
	and $\Zvec = (\mathbf{X} + i\mathbf{Y}) / \sqrt{2}$ is an $L$-dimensional standard complex-valued Wiener process (with $\langle \upd Z_j \upd Z_k^* \rangle = \delta_{jk} \upd t$), containing two standard $L$-dimensional Wiener processes $\mathbf{X}$ and $\mathbf{Y}$.
\end{theorem}
\begin{proof}
Let us expand the \abbrev{fpe} using real values $\balpha = \xvec + i \yvec$, $\avec = \mathbf{u} + i \mathbf{v}$, $B = F + iG$, $\vcwd_{\balpha} = (\vcwd_{\xvec} - i \vcwd_{\yvec}) / 2$.
Thus
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & - \vcwd_{\xvec}^T \mathbf{u} W
	- \vcwd_{\yvec}^T \mathbf{v} W
	+ \frac{1}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\xvec}^T
			+ \vcwd_{\yvec} \vcwd_{\yvec}^T)
		(F F^T + G G^T) \right. \\
	& \left. - (\vcwd_{\xvec} \vcwd_{\yvec}^T
			- \vcwd_{\yvec} \vcwd_{\xvec}^T)
		(F G^T - G F^T)
	} W \\
	& + \frac{i}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\xvec}^T
			+ \vcwd_{\yvec} \vcwd_{\yvec}^T)
		(F G^T - G F^T)
	} W \\
	& + \frac{i}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\yvec}^T
			- \vcwd_{\yvec} \vcwd_{\xvec}^T)
		(F F^T + G G^T)
	} W.
\end{eqn}
Since $F F^T + G G^T$ and $\vcwd_{\xvec} \vcwd_{\xvec}^T + \vcwd_{\yvec} \vcwd_{\yvec}^T$ are symmetric matrices, and $F G^T - G F^T$ and $\vcwd_{\xvec} \vcwd_{\yvec}^T - \vcwd_{\yvec} \vcwd_{\xvec}^T$ are antisymmetric, corresponding traces are equal to zero, which gives us \abbrev{fpe} in real variables
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & - \vcwd_{\xvec}^T \mathbf{u} W
	- \vcwd_{\yvec}^T \mathbf{v} W
	+ \frac{1}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\xvec}^T
			+ \vcwd_{\yvec} \vcwd_{\yvec}^T)
		(F F^T + G G^T) \right. \\
	& \left. - (\vcwd_{\xvec} \vcwd_{\yvec}^T
			- \vcwd_{\yvec} \vcwd_{\xvec}^T)
		(F G^T - G F^T)
	} W.
\end{eqn}

In order to use \lmmref{fpe-sde:corr:fpe-sde-real},
we need to join variables $\xvec$ and $\yvec$ into one variable vector $\zvec \equiv \xvec \oplus \yvec$.
This will give us the equation in the form identical to that from the lemma, with the drift vector $\tilde{\avec} \equiv \mathbf{u} \oplus \mathbf{v}$ and the diffusion matrix
\begin{eqn}
	\tilde{B} \tilde{B}^T \equiv \frac{1}{2} \begin{pmatrix}
		F F^T + G G^T & F G^T - G F^T \\
		G F^T - F G^T & F F^T + G G^T
	\end{pmatrix},
\end{eqn}
which gives the noise matrix
\begin{eqn}
	\tilde{B} = \frac{1}{\sqrt{2}} \begin{pmatrix}
		F & -G \\
		G & F
	\end{pmatrix}.
\end{eqn}
Therefore the equivalent \abbrev{sde}s in It\^{o} form are
\begin{eqn}
	d\zvec = \tilde{\avec} dt + \tilde{B} d\tilde{\Zvec},
\end{eqn}
where $d\tilde{\Zvec} \equiv d\mathbf{X} \oplus d\mathbf{Y}$.
Returning to our previous variables:
\begin{eqn}
	d\xvec & = \mathbf{u} dt + \frac{1}{\sqrt{2}} F d\mathbf{X} - \frac{1}{\sqrt{2}} G d\mathbf{Y}, \\
	d\yvec & = \mathbf{v} dt + \frac{1}{\sqrt{2}} G d\mathbf{X} + \frac{1}{\sqrt{2}} F d\mathbf{Y}.
\end{eqn}
Multiplying the second equation by $i$ and adding it to the first one:
\begin{eqn}
	d\balpha = \avec dt + \frac{1}{\sqrt{2}} (F + iG) (d\mathbf{X} + id\mathbf{Y}),
\end{eqn}
which leads to the It\^{o} part of the theorem statement.
\begin{eqn}
	d\balpha = \avec dt + B d\Zvec.
\end{eqn}

Noise-induced drift term in Stratonovich case can be calculated by substituting $\tilde{B}$ into the expression for $s_j$ from \lmmref{fpe-sde:corr:fpe-sde-real}.
We will calculate $s_j$ with $j$ belonging to $\xvec$ and $\yvec$ part of coordinate space separately.
\begin{eqn}
	s_j^{(x)}
	= \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\vcwd_{\xvec} \\
			\vcwd_{\yvec}
		\end{pmatrix}
		\begin{pmatrix}
			\evec_j^T & 0
		\end{pmatrix}
		\begin{pmatrix}
			F & -G \\ G & F
		\end{pmatrix}
	}
\end{eqn}
Multiplying matrices:
\begin{eqn}
	={} & \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\vcwd_{\xvec} \\
			\vcwd_{\yvec}
		\end{pmatrix}
		\begin{pmatrix}
			\evec_j^T F & - \evec_j^T G
		\end{pmatrix}
	} \\
	={} & \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\vcwd_{\xvec} \evec_j^T F & - \vcwd_{\xvec} \evec_j^T G \\
			\vcwd_{\yvec} \evec_j^T F & - \vcwd_{\yvec} \evec_j^T G
		\end{pmatrix}
	} \\
	={} & \frac{1}{4} \left(
		\Trace{ F^T \vcwd_{\xvec} \evec_j^T F }
		+ \Trace{ G^T \vcwd_{\yvec} \evec_j^T F } \right. \\
	& \left. + \Trace{ G^T \vcwd_{\xvec} \evec_j^T G }
		- \Trace{ F^T \vcwd_{\yvec} \evec_j^T G }
	\right).
\end{eqn}
Similarly for the $\yvec$ part,
\begin{eqn}
	s_j^{(y)}
	={} & \frac{1}{4} \left(
		\Trace{ F^T \vcwd_{\xvec} \evec_j^T G }
		+ \Trace{ G^T \vcwd_{\yvec} \evec_j^T G } \right. \\
	& \left. - \Trace{ G^T \vcwd_{\xvec} \evec_j^T F }
		+ \Trace{ F^T \vcwd_{\yvec} \evec_j^T F }
	\right).
\end{eqn}
Therefore the final term in complex-valued \abbrev{sde}s is
\begin{eqn}
	s_j
	= s_j^{(x)} + i s_j^{(y)}
	= \frac{1}{2} \Trace{ B^H \vcwd_{\balpha^*} \evec_j^T B },
\end{eqn}
which finishes the proof.
\end{proof}

Note the asymmetry in the expression for Stratonovich term: if $B = B(\alpha)$, then $\mathbf{s} \equiv 0$.
It is initially caused by the asymmetry in the target \abbrev{sde}s.
Truly general form of \abbrev{fpe} would be
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & - 2 \Real \left( \vcwd_{\balpha}^T \avec \right) W
	+ \Trace{ \vcwd_{\balpha^*} \vcwd_{\balpha}^T B_1 B_1^H } W
	+ \Trace{ \vcwd_{\balpha^*} \vcwd_{\balpha}^T B_2 B_2^H } W \\
	& + 2 \Real \left(
		\Trace{ \vcwd_{\balpha} \vcwd_{\balpha}^T B_1 B_2^T }
		+ \Trace{ \vcwd_{\balpha} \vcwd_{\balpha}^T B_2 B_1^T }
	\right) W,
\end{eqn}
which corresponds to the system of \abbrev{sde}s
\begin{eqn}
	\upd\balpha = (\avec - \svec) \upd t + B_1 \upd\Zvec + B_2 \upd\Zvec^*,
\end{eqn}
where the Stratonovich term has elements
\begin{eqn}
	s_j ={} & \frac{1}{2} \left(
		\Trace{ B_1^H \vcwd_{\balpha^*} \evec_j^T B_1 }
		+ \Trace{ B_2^H \vcwd_{\balpha^*} \evec_j^T B_2 } \right. \\
		& \left. + \Trace{ B_1^T \vcwd_{\balpha} \evec_j^T B_2 }
		+ \Trace{ B_2^T \vcwd_{\balpha} \evec_j^T B_1 }
	\right).
\end{eqn}
In the theorem above we limited the space of possible \abbrev{sde}s to those with $B_2 \equiv 0$, leading to the observed asymmetry.

In many applications (some of which are discussed in this thesis), it is advantageous to enumerate state vector of the system with two variables instead of one: mode numbers and component numbers.
This helps to describe particles which can occupy the same set of modes, but are otherwise distinguishable.
We will now reformulate the previous theorem, including this component distinction.

\begin{theorem}[Multi-component reformulation of \thmref{fpe-sde:corr:fpe-sde-complex}]
\label{thm:fpe-sde:corr:mc-fpe-sde}
	If $\balpha^{(j)},\, j = 1 \ldots C$ are $C$ sets of complex variables $\balpha^{(j)} \equiv (\alpha_1^{(j)} \ldots \alpha_{M_j}^{(j)})$, then a \abbrev{fpe}
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		={} & - \sum_{j=1}^C \vcwd_{\balpha^{(j)}}^T \avec^{(j)} W
		- \sum_{j=1}^C \vcwd_{(\balpha^{(j)})^*}^T (\avec^{(j)})^* W \\
		& + \sum_{j=1}^C \sum_{k=1}^C
			\Trace{
				\vcwd_{(\balpha^{(j)})^*}
				\vcwd_{\balpha^{(k)}}^T
				B^{(k)} (B^{(j)})^H
			} W
	\end{eqn*}
	is equivalent to a set of \abbrev{sde}s in It\^{o} form
	\begin{eqn*}
		\upd\balpha^{(j)} = \avec^{(j)} \upd t + B^{(j)} \upd\Zvec,
	\end{eqn*}
	or to a set of \abbrev{sde}s in Stratonovich form
	\begin{eqn*}
		\upd\balpha^{(j)} = (\avec^{(j)} - \svec^{(j)}) \upd t + B^{(j)} \upd\Zvec,
	\end{eqn*}
	where the Stratonovich term has elements
	\begin{eqn*}
		s_i^{(j)} = \frac{1}{2} \sum_{k=1}^C
			\Trace{ (B^{(k)})^H \vcwd_{(\balpha^{(k)})^*} \evec_i^T B^{(j)} }.
	\end{eqn*}
	Here $\upd\Zvec$ is an $L$-dimensional standard complex-valued Wiener process, and noise matrices $B^{(j)}$ have sizes $M_j \times L$.
\end{theorem}
\begin{proof}
Let us join all variable sets $\balpha^{(j)}$ into a single set
\begin{eqn}
	\balpha \equiv \bigoplus_{j=1}^C \balpha^{(j)}.
\end{eqn}
Then we can use \thmref{fpe-sde:corr:fpe-sde-complex} with the drift vector
\begin{eqn}
	\avec = \bigoplus_{j=1}^C \avec^{(j)},
\end{eqn}
the cogradient vector
\begin{eqn}
	\vcwd_{\balpha} = \bigoplus_{j=1}^C \vcwd_{\balpha^{(j)}},
\end{eqn}
and the noise matrix
\begin{eqn}
	B = \begin{pmatrix}
		B^{(1)} \\ \vdots \\ B^{(C)}
	\end{pmatrix}.
\end{eqn}
This gives us \abbrev{sde}s in It\^{o} form
\begin{eqn}
	\upd\balpha = \avec \upd t + B \upd\Zvec,
\end{eqn}
where $d\Zvec$ is an $L$-dimensional standard complex-valued Wiener process.
Splitting this equation for different components, we get the It\^{o} part of the theorem statement.
Subsituting $B$ into the expression for the Stratonovich term:
\begin{eqn}
	s_i^{(j)}
	& = \frac{1}{2} \Trace{
		\begin{pmatrix} (B^{(1)})^H & \cdots & (B^{(C)})^H \end{pmatrix}
		\begin{pmatrix}
			\vcwd_{(\balpha^{(1)})^*} \\
			\vdots \\
			\vcwd_{(\balpha^{(C)})^*}
		\end{pmatrix}
		\begin{pmatrix} 0 & \cdots & \evec_i^T & \cdots & 0 \end{pmatrix}
		\begin{pmatrix}
			B^{(1)} \\
			\vdots \\
			B^{(C)}
		\end{pmatrix}
	}.
\end{eqn}
Multiplying matrices successively:
\begin{eqn}
	& = \frac{1}{2} \Trace{
		\begin{pmatrix} (B^{(1)})^H & \cdots & (B^{(C)})^H \end{pmatrix}
		\begin{pmatrix}
			\vcwd_{(\balpha^{(1)})^*} \evec_i^T B^{(j)} \\
			\vdots \\
			\vcwd_{(\balpha^{(C)})^*} \evec_i^T B^{(j)}
		\end{pmatrix}
	} \\
	& = \frac{1}{2} \sum_{k=1}^C \Trace{
		(B^{(k)})^H
		\vcwd_{(\balpha^{(k)})^*}
		\evec_i^T
		B^{(j)}
	},
\end{eqn}
which is the expression from the theorem statement.
\end{proof}

Most of the time we will deal with \abbrev{fpe}s in functional form, so we will reformulate the correspondence once again, now using functional derivatives.

\begin{theorem}
\label{thm:fpe-sde:corr:fpe-sde-func}
	A \abbrev{fpe} in functional form
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		={} & \int \upd\xvec \left(
			- \sum_{j=1}^C \frac{\fdelta}{\fdelta \Psi_j} \mathcal{A}_j W
			- \sum_{j=1}^C \frac{\fdelta}{\fdelta \Psi_j^*} \mathcal{A}_j^* W \right. \\
		& \left. + \sum_{j=1}^C \sum_{k=1}^C \frac{\fdelta^2}{\fdelta \Psi_j^* \fdelta \Psi_k}
				\sum_{\lvec \in \mathbb{L}} \mathcal{B}_{k,\lvec} \mathcal{B}_{j,\lvec}^* W
		\right)
	\end{eqn*}
	is equivalent to a the set of \abbrev{sde}s in It\^{o} form
	\begin{eqn*}
		\upd\Psi_j = \mathcal{P}_{\restbasis_j} \left[
			\mathcal{A}_j \upd t
			+ \sum_{\lvec \in \mathbb{L}} \mathcal{B}_{j,\lvec} \upd Q_{\lvec}
		\right],
	\end{eqn*}
	or a the set of \abbrev{sde}s in It\^{o} form
	\begin{eqn*}
		\upd\Psi_j = \mathcal{P}_{\restbasis_j} \left[
			(\mathcal{A}_j - \mathcal{S}_j) \upd t
			+ \sum_{\lvec \in \mathbb{L}} \mathcal{B}_{j,\lvec} \upd Q_{\lvec}
		\right],
	\end{eqn*}
	where
	\begin{eqn*}
		\mathcal{S}_j = \frac{1}{2} \sum_{k=1}^C \sum_{\lvec \in \mathbb{L}}
			\mathcal{B}_{k,\lvec}^*
			\frac{\fdelta}{\fdelta \Psi_k^*}
			\mathcal{B}_{j,\lvec}.
	\end{eqn*}
	Here $\Psi_j \in \mathbb{F}_{\mathbb{M}_j}$, $\mathcal{A}_j \equiv \mathcal{A}_j[\bPsi]$ and $\mathcal{B}_{j,\lvec} \equiv \mathcal{B}_{j,\lvec}[\bPsi]$ are functional operators, $W \equiv W[\bPsi]$ is a probability functional, and $\mathbb{L}$ is a set of noise sources.
	Functional Wiener processes $Q_{\lvec}$ are compositions of standard complex-valued Wiener processes:
	\begin{eqn*}
		Q_{\lvec} = \sum_{\nvec \in \fullbasis} \phi_{\nvec} Z_{\lvec,\nvec}.
	\end{eqn*}
\end{theorem}
\begin{proof}
Expanding functional derivatives according to \defref{func-calculus:func-diff} with $\Psi_j = \sum_{\nvec \in \restbasis_j} \phi_{j,\nvec} \alpha_{j,\nvec}$:
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & \left(
		- \sum_{j=1}^C \sum_{\nvec \in \restbasis_j}
			\frac{\cwd}{\cwd \alpha_{j,\nvec}}
			\int \upd\xvec\, \phi_{j,\nvec}^* \mathcal{A}_j W
		- \sum_{j=1}^C \sum_{\nvec \in \restbasis_j}
			\frac{\cwd}{\cwd \alpha_{j,\nvec}^*}
			\int \upd\xvec\, \phi_{j,\nvec} \mathcal{A}_j^* W
		\right. \\
	&	\left. + \sum_{j=1}^C \sum_{k=1}^C
			\sum_{\mvec \in \restbasis_j, \nvec \in \restbasis_k}
			\frac{\cwd}{\cwd \alpha_{j,\mvec}^*}
			\frac{\cwd}{\cwd \alpha_{k,\nvec}}
			\int \upd\xvec
			\phi_{j,\mvec} \phi_{k,\nvec}^*
			\sum_{\lvec \in \mathbb{L}} \mathcal{B}_{j,\lvec}^* \mathcal{B}_{k,\lvec} W
	\right).
\end{eqn}
The diffusion term has to be transformed in order to conform to \thmref{fpe-sde:corr:mc-fpe-sde}:
\begin{eqn}
	\int \upd\xvec \phi_{j,\mvec} \phi_{k,\nvec}^* \sum_{\lvec \in \mathbb{L}}
		\mathcal{B}_{k,\lvec} \mathcal{B}_{j,\lvec}^*
	& = \int \upd\xvec \int \upd\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{\lvec \in \mathbb{L}} \mathcal{B}_{j,\lvec}^{\prime *} \mathcal{B}_{k,\lvec}
			\delta(\xvec - \xvec^\prime) \\
	& = \int \upd\xvec \int \upd\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{\lvec \in \mathbb{L}} \mathcal{B}_{j,\lvec}^{\prime *} \mathcal{B}_{k,\lvec}
			\sum_{\pvec \in \fullbasis} \phi_{\pvec}^{\prime*} \phi_{\pvec} \\
	& = \sum_{\lvec \in \mathbb{L}} \sum_{\pvec \in \fullbasis}
		\int \upd\xvec\,
			\phi_{j,\mvec} \mathcal{B}_{j,\lvec}^* \phi_{\pvec}^*
		\int \upd\xvec\,
			\phi_{k,\nvec}^* \mathcal{B}_{k,\lvec} \phi_{\pvec}.
\end{eqn}
Note that we did not specify the index of the full basis used to expand the delta function.
It can be any orthonormal and complete basis, in particular one of $\fullbasis_j$ --- this will not change the result.

Now we have the \abbrev{fpe} in the from required by \thmref{fpe-sde:corr:mc-fpe-sde} with
\begin{eqn}
	a_{\mvec}^{(j)}
	= \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{A}_j,\,
	\mvec \in \restbasis_j,
\end{eqn}
and
\begin{eqn}
\label{eqn:fpe-sde:corr:func-noise-matrix}
	B_{\mvec,(\pvec,\lvec)}^{(j)}
	= \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{B}_{j,\lvec} \phi_{\pvec},\,
	\mvec \in \restbasis_j, \pvec \in \fullbasis, \lvec \in \mathbb{L}.
\end{eqn}
Note that columns of $B$ are enumerated using the compound index $\pvec,\lvec$.

Therefore the initial \abbrev{fpe} is equivalent to the set of \abbrev{sde}s in It\^{o} form
\begin{eqn}
	\upd\alpha_{\mvec}^{(j)}
	= \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{A}_j \upd t
	+ \sum_{\pvec \in \fullbasis, \lvec \in \mathbb{L}}
		\int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{B}_{j,\lvec} \phi_{\pvec} \upd Z_{\pvec,\lvec}.
\end{eqn}
Multiplying by $\phi_{j,\mvec}^\prime$ and grouping by component:
\begin{eqn}
	\sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \upd\alpha_{\mvec}^{(j)}
	={} & \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{A}_j \upd t \\
	& + \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \int \upd\xvec\, \phi_{j,\mvec}^*
		\sum_{\lvec \in \mathbb{L}} \sum_{\pvec \in \fullbasis}
			\mathcal{B}_{j,\lvec} \phi_{\pvec} \upd Z_{\pvec,\lvec}.
\end{eqn}
Recognizing \defref{func-calculus:projector} of the projection operator:
\begin{eqn}
	\upd\Psi_j
	= \proj{\restbasis_j} \left[
		\mathcal{A}_j \upd t
		+ \sum_{\lvec \in \mathbb{L}} \mathcal{B}_{j,\lvec}
			\sum_{\pvec \in \fullbasis} \phi_{\pvec} \upd Z_{\pvec,\lvec}
	\right].
\end{eqn}
Defining the functional Wiener process as $Q_{\lvec} = \sum_{\pvec \in \fullbasis} \phi_{\pvec} \upd Z_{\pvec,\lvec}$:
\begin{eqn}
	\upd\Psi_c
	= \proj{\restbasis_j} \left[
		\mathcal{A}_j \upd t
		+ \sum_{\lvec \in \mathbb{L}} \mathcal{B}_{j,\lvec} \upd Q_{\lvec}
	\right].
\end{eqn}

Performing the same multiplication and summation on the Stratonovich term from \thmref{fpe-sde:corr:mc-fpe-sde}:
\begin{eqn}
	\mathcal{S}_j
	= \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime s_{\mvec}^{(j)}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \sum_{k=1}^C \Trace{
		(B^{(k)})^H \vcwd_{(\balpha^{(k)})^*} \evec_{\mvec}^T B^{(j)}
	}.
\end{eqn}
Transforming the trace to a summation:
\begin{eqn}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_c} \phi_{j,\mvec}^\prime \sum_{k=1}^C
		\sum_{\nvec \in \restbasis_k} \sum_{\lvec \in \mathbb{L}} \sum_{\pvec \in \fullbasis}
			(B_{\nvec (\pvec,\lvec)}^{(k)})^*
			\frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
			B_{\mvec (\pvec,\lvec)}^{(j)}.
\end{eqn}
Using the multimode form~\eqnref{fpe-sde:corr:func-noise-matrix} of the noise matrix:
\begin{eqn}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \sum_{k=1}^C
		\sum_{\nvec \in \restbasis_k} \sum_{\lvec \in \mathbb{L}} \sum_{\pvec \in \fullbasis}
			\int \upd\xvec\, \phi_{k,\nvec} \mathcal{B}_{k,\lvec}^* \phi_{\pvec}^*
			\int \upd\xvec\, \phi_{j,\mvec}^*
				\frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
				\mathcal{B}_{j,\lvec} \phi_{\pvec}.
\end{eqn}
Substituting $\sum_{\pvec \in \fullbasis} \phi_{\pvec}^* \phi_{\pvec} = \delta(\xvec - \xvec^\prime)$:
\begin{eqn}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime
		\sum_{k=1}^C \sum_{\nvec \in \restbasis_k} \sum_{\lvec \in \mathbb{L}}
			\int \upd\xvec\,
				\phi_{k,\nvec} \mathcal{B}_{k,\lvec}^*
				\phi_{j,\mvec}^* \frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
				\mathcal{B}_{j,\lvec}.
\end{eqn}
Recognizing the projection transformation and the functional differential:
\begin{eqn}
	& = \proj{\restbasis_j} \left[
		\frac{1}{2} \sum_{k=1}^C \sum_{\nvec \in \restbasis_k} \sum_{\lvec \in \mathbb{L}}
			\phi_{k,\nvec} \mathcal{B}_{k,\lvec}^*
			\frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
			\mathcal{B}_{j,\lvec}
	\right] \\
	& = \proj{\restbasis_j} \left[
		\frac{1}{2} \sum_{k=1}^C \sum_{\lvec \in \mathbb{L}}
		\mathcal{B}_{k,\lvec}^*
		\frac{\fdelta}{\fdelta \Psi_k^*}
		\mathcal{B}_{j,\lvec}
	\right].
	\qedhere
\end{eqn}
\end{proof}

Alternatively, the \abbrev{fpe} from the above theorem can be expressed in a short matrix form:
\begin{eqn}
	\frac{dW}{dt}
	= \int d\xvec \left(
		- \vfdelta_{\bPsi} \cdot \mathbf{\mathcal{A}} W
		- \vfdelta_{\bPsi^*} \cdot \mathbf{\mathcal{A}}^* W
		+ \Trace{ \vfdelta_{\bPsi^*} \vfdelta_{\bPsi}^T \mathcal{B} \mathcal{B}^H } W
	\right),
\end{eqn}
where the functional cogradient $\vfdelta_{\bPsi} = \left( \fdelta/\fdelta \Psi_1 \ldots \fdelta/\fdelta \Psi_C \right)$, $\mathbf{\mathcal{A}}$ is a vector of $C$ functional operators, and $\mathcal{B}$ is a matrix of $C \times |\mathbb{L}|$ functional operators.

