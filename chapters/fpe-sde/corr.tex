% =============================================================================
\section{Correspondences}
% =============================================================================

We will start by formulating the known real-valued correspondence in a form which is more convenient for further proofs in this section, and is also closer to the results one obtains from the Wigner transformation.

\begin{lemma}[real-valued \abbrev{fpe}--\abbrev{sde}s correspondence in a convenient form.]
\label{lmm:fpe-sde:corr:fpe-sde-real}
	Let $\zvec^T \equiv (z_1 \ldots z_M)$ be a set of real variables.
	Then the \abbrev{fpe}
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		= -\vcwd_{\zvec}^T \cdot \avec W
		+ \frac{1}{2} \Trace{ \vcwd_{\zvec} \vcwd_{\zvec}^T B B^T } W
	\end{eqn*}
	is equivalent to the set of \abbrev{sde}s in the It\^o form
	\begin{eqn*}
		\upd\zvec = \avec \upd t + B \upd\Zvec
	\end{eqn*}
	and to the set of \abbrev{sde}s in the Stratonovich form
	\begin{eqn*}
		\upd\zvec = (\avec - \svec)\upd t + B \upd\Zvec,
	\end{eqn*}
	where the noise-induced (Stratonovich) drift vector $\svec$ has elements
	\begin{eqn*}
		s_j
		= \frac{1}{2} \sum_{k,i} B_{ki} \frac{\cwd}{\cwd z_k} B_{ji}
		= \frac{1}{2} \Trace{B^T \vcwd_{\zvec} \evec_j^T B},
	\end{eqn*}
	with $\evec_j$ being a unit vector with elements $(\evec_j)_i = \delta_{ij}$.
	Here $W \equiv W(\zvec)$ is a probability distribution, $\avec \equiv \avec(\zvec)$ is a vector function, $B \equiv B(\zvec)$ is a matrix function ($B$ having the size $M \times L$, where $L$ is the number of noise sources), $\vcwd_{\zvec}^T \equiv (\upd/\upd z_1 \ldots \upd/\upd z_M)$ is a cogradient vector, and $\Zvec$ is a standard $L$-dimensional Wiener process with $\langle \upd Z_j^2 \rangle = \upd t$.
\end{lemma}
\begin{proof}
For the detailed proof see Risken~\cite{Risken1996}, sections 3.3 and 3.4.
\end{proof}

The above theorem can be extended to work with complex Wirtinger derivatives and complex-valued coefficients.
Of course, in order to produce a real-valued $\upd W/\upd t$ in the left-hand part, an \abbrev{fpe} must have a particular form.

\begin{theorem}
\label{thm:fpe-sde:corr:fpe-sde-complex}
	Let $\balpha^T \equiv (\alpha_1 \ldots \alpha_M)$ be a set of complex variables.
	Then the \abbrev{fpe}
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		= -\vcwd_{\balpha}^T \avec W - \vcwd_{\balpha^*}^T \avec^* W
		+ \Trace{ \vcwd_{\balpha^*} \vcwd_{\balpha}^T B B^H } W
	\end{eqn*}
	is equivalent to the set of \abbrev{sde}s in the It\^o form
	\begin{eqn*}
		\upd\balpha = \avec \upd t + B \upd\Zvec,
	\end{eqn*}
	and to the set of \abbrev{sde}s in the Stratonovich form
	\begin{eqn*}
		\upd\balpha = (\avec - \svec) \upd t + B \upd\Zvec,
	\end{eqn*}
	where the Stratonovich term has elements
	\begin{eqn*}
		s_j = \frac{1}{2} \Trace{ B^H \vcwd_{\balpha^*} \evec_j^T B },
	\end{eqn*}
	and $\Zvec = (\mathbf{X} + i\mathbf{Y}) / \sqrt{2}$ is an $L$-dimensional standard complex-valued Wiener process (with $\langle \upd Z_j \upd Z_k^* \rangle = \delta_{jk} \upd t$), containing two standard $L$-dimensional Wiener processes $\mathbf{X}$ and $\mathbf{Y}$.
\end{theorem}
\begin{proof}
Let us expand the \abbrev{fpe} using real variables: $\balpha = \xvec + i \yvec$, $\avec = \mathbf{u} + i \mathbf{v}$, $B = F + iG$, $\vcwd_{\balpha} = (\vcwd_{\xvec} - i \vcwd_{\yvec}) / 2$.
This results in
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & - \vcwd_{\xvec}^T \mathbf{u} W
	- \vcwd_{\yvec}^T \mathbf{v} W
	+ \frac{1}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\xvec}^T
			+ \vcwd_{\yvec} \vcwd_{\yvec}^T)
		(F F^T + G G^T) \right. \\
	& \left. - (\vcwd_{\xvec} \vcwd_{\yvec}^T
			- \vcwd_{\yvec} \vcwd_{\xvec}^T)
		(F G^T - G F^T)
	} W \\
	& + \frac{i}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\xvec}^T
			+ \vcwd_{\yvec} \vcwd_{\yvec}^T)
		(F G^T - G F^T)
	} W \\
	& + \frac{i}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\yvec}^T
			- \vcwd_{\yvec} \vcwd_{\xvec}^T)
		(F F^T + G G^T)
	} W.
\end{eqn}
Since $F F^T + G G^T$ and $\vcwd_{\xvec} \vcwd_{\xvec}^T + \vcwd_{\yvec} \vcwd_{\yvec}^T$ are symmetric matrices, and $F G^T - G F^T$ and $\vcwd_{\xvec} \vcwd_{\yvec}^T - \vcwd_{\yvec} \vcwd_{\xvec}^T$ are antisymmetric ones, the corresponding traces are equal to zero, which gives us the \abbrev{fpe} in real variables
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & - \vcwd_{\xvec}^T \mathbf{u} W
	- \vcwd_{\yvec}^T \mathbf{v} W
	+ \frac{1}{4} \Trace{
		(\vcwd_{\xvec} \vcwd_{\xvec}^T
			+ \vcwd_{\yvec} \vcwd_{\yvec}^T)
		(F F^T + G G^T) \right. \\
	& \left. - (\vcwd_{\xvec} \vcwd_{\yvec}^T
			- \vcwd_{\yvec} \vcwd_{\xvec}^T)
		(F G^T - G F^T)
	} W.
\end{eqn}

In order to use \lmmref{fpe-sde:corr:fpe-sde-real}, we need to merge variables $\xvec$ and $\yvec$ into one variable vector $\zvec \equiv \xvec \oplus \yvec$.
This will give us an equation in the form identical to that from the lemma, with drift vector $\tilde{\avec} \equiv \mathbf{u} \oplus \mathbf{v}$ and diffusion matrix
\begin{eqn}
	\tilde{B} \tilde{B}^T \equiv \frac{1}{2} \begin{pmatrix}
		F F^T + G G^T & F G^T - G F^T \\
		G F^T - F G^T & F F^T + G G^T
	\end{pmatrix},
\end{eqn}
which gives the noise matrix
\begin{eqn}
	\tilde{B} = \frac{1}{\sqrt{2}} \begin{pmatrix}
		F & -G \\
		G & F
	\end{pmatrix}.
\end{eqn}
Therefore, the equivalent \abbrev{sde}s in the It\^o form are
\begin{eqn}
	d\zvec = \tilde{\avec} dt + \tilde{B} d\tilde{\Zvec},
\end{eqn}
where $d\tilde{\Zvec} \equiv d\mathbf{X} \oplus d\mathbf{Y}$.
Returning to the previous variables:
\begin{eqn}
	d\xvec & = \mathbf{u} dt + \frac{1}{\sqrt{2}} F d\mathbf{X} - \frac{1}{\sqrt{2}} G d\mathbf{Y}, \\
	d\yvec & = \mathbf{v} dt + \frac{1}{\sqrt{2}} G d\mathbf{X} + \frac{1}{\sqrt{2}} F d\mathbf{Y}.
\end{eqn}
Multiplying the second equation by $i$ and adding it to the first one:
\begin{eqn}
	d\balpha = \avec dt + \frac{1}{\sqrt{2}} (F + iG) (d\mathbf{X} + id\mathbf{Y}),
\end{eqn}
which leads to the It\^o part of the theorem statement
\begin{eqn}
	d\balpha = \avec dt + B d\Zvec.
\end{eqn}

The noise-induced drift term in the Stratonovich case can be calculated by substituting $\tilde{B}$ into the expression for $s_j$ from \lmmref{fpe-sde:corr:fpe-sde-real}.
We will calculate $s_j$ with $j$ belonging to the $\xvec$ and the $\yvec$ part of the coordinate space separately.
Starting from the $\xvec$ part:
\begin{eqn}
	s_j^{(x)}
	= \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\vcwd_{\xvec} \\
			\vcwd_{\yvec}
		\end{pmatrix}
		\begin{pmatrix}
			\evec_j^T & 0
		\end{pmatrix}
		\begin{pmatrix}
			F & -G \\ G & F
		\end{pmatrix}
	}.
\end{eqn}
Multiplying the matrices, we get:
\begin{eqn}
	={} & \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\vcwd_{\xvec} \\
			\vcwd_{\yvec}
		\end{pmatrix}
		\begin{pmatrix}
			\evec_j^T F & - \evec_j^T G
		\end{pmatrix}
	} \\
	={} & \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\vcwd_{\xvec} \evec_j^T F & - \vcwd_{\xvec} \evec_j^T G \\
			\vcwd_{\yvec} \evec_j^T F & - \vcwd_{\yvec} \evec_j^T G
		\end{pmatrix}
	} \\
	={} & \frac{1}{4} \left(
		\Trace{ F^T \vcwd_{\xvec} \evec_j^T F }
		+ \Trace{ G^T \vcwd_{\yvec} \evec_j^T F } \right. \\
	& \left. + \Trace{ G^T \vcwd_{\xvec} \evec_j^T G }
		- \Trace{ F^T \vcwd_{\yvec} \evec_j^T G }
	\right).
\end{eqn}
Similarly for the $\yvec$ part,
\begin{eqn}
	s_j^{(y)}
	={} & \frac{1}{4} \left(
		\Trace{ F^T \vcwd_{\xvec} \evec_j^T G }
		+ \Trace{ G^T \vcwd_{\yvec} \evec_j^T G } \right. \\
	& \left. - \Trace{ G^T \vcwd_{\xvec} \evec_j^T F }
		+ \Trace{ F^T \vcwd_{\yvec} \evec_j^T F }
	\right).
\end{eqn}
Therefore, the final term in the complex-valued \abbrev{sde}s is
\begin{eqn}
	s_j
	= s_j^{(x)} + i s_j^{(y)}
	= \frac{1}{2} \Trace{ B^H \vcwd_{\balpha^*} \evec_j^T B },
\end{eqn}
which finishes the proof.
\end{proof}

Note the asymmetry in the expression for the Stratonovich term: if $B = B(\alpha)$, then $\mathbf{s} \equiv 0$.
This is initially caused by the asymmetry in the target \abbrev{sde}s.
A truly general form of an \abbrev{fpe} would be
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & - 2 \Real \left( \vcwd_{\balpha}^T \avec \right) W
	+ \Trace{ \vcwd_{\balpha^*} \vcwd_{\balpha}^T B_1 B_1^H } W
	+ \Trace{ \vcwd_{\balpha^*} \vcwd_{\balpha}^T B_2 B_2^H } W \\
	& + 2 \Real \left(
		\Trace{ \vcwd_{\balpha} \vcwd_{\balpha}^T B_1 B_2^T }
		+ \Trace{ \vcwd_{\balpha} \vcwd_{\balpha}^T B_2 B_1^T }
	\right) W,
\end{eqn}
which corresponds to the system of \abbrev{sde}s
\begin{eqn}
	\upd\balpha = (\avec - \svec) \upd t + B_1 \upd\Zvec + B_2 \upd\Zvec^*,
\end{eqn}
where the Stratonovich term has elements
\begin{eqn}
	s_j ={} & \frac{1}{2} \left(
		\Trace{ B_1^H \vcwd_{\balpha^*} \evec_j^T B_1 }
		+ \Trace{ B_2^H \vcwd_{\balpha^*} \evec_j^T B_2 } \right. \\
		& \left. + \Trace{ B_1^T \vcwd_{\balpha} \evec_j^T B_2 }
		+ \Trace{ B_2^T \vcwd_{\balpha} \evec_j^T B_1 }
	\right).
\end{eqn}
In the theorem above we limited the space of possible \abbrev{sde}s to those with $B_2 \equiv 0$, leading to the observed asymmetry.

In many applications (some of which are discussed in this thesis), it is advantageous to enumerate the state vector of a system using two variables instead of one, namely the mode identifier and the component number.
This helps to describe particles which can occupy the same set of modes, but are otherwise distinguishable.
We will now reformulate the previous theorem, including this component distinction.

\begin{theorem}[multi-component reformulation of \thmref{fpe-sde:corr:fpe-sde-complex}]
\label{thm:fpe-sde:corr:mc-fpe-sde}
	Let $\balpha^{(j)},\, j = 1 \ldots C$ be $C$ sets of complex variables $\balpha^{(j)} \equiv (\alpha_1^{(j)} \ldots \alpha_{M_j}^{(j)})$.
	Then the \abbrev{fpe}
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		={} & - \sum_{j=1}^C \vcwd_{\balpha^{(j)}}^T \avec^{(j)} W
		- \sum_{j=1}^C \vcwd_{(\balpha^{(j)})^*}^T (\avec^{(j)})^* W \\
		& + \sum_{j=1}^C \sum_{k=1}^C
			\Trace{
				\vcwd_{(\balpha^{(j)})^*}
				\vcwd_{\balpha^{(k)}}^T
				B^{(k)} (B^{(j)})^H
			} W
	\end{eqn*}
	is equivalent to the set of \abbrev{sde}s in the It\^o form
	\begin{eqn*}
		\upd\balpha^{(j)} = \avec^{(j)} \upd t + B^{(j)} \upd\Zvec,
	\end{eqn*}
	or to the set of \abbrev{sde}s in the Stratonovich form
	\begin{eqn*}
		\upd\balpha^{(j)} = (\avec^{(j)} - \svec^{(j)}) \upd t + B^{(j)} \upd\Zvec,
	\end{eqn*}
	where the Stratonovich term has elements
	\begin{eqn*}
		s_i^{(j)} = \frac{1}{2} \sum_{k=1}^C
			\Trace{ (B^{(k)})^H \vcwd_{(\balpha^{(k)})^*} \evec_i^T B^{(j)} }.
	\end{eqn*}
	Here $\Zvec$ is an $L$-dimensional standard complex-valued Wiener process, and the noise matrices $B^{(j)}$ have sizes $M_j \times L$.
\end{theorem}
\begin{proof}
Let us join all variable sets $\balpha^{(j)}$ into a single set
\begin{eqn}
	\balpha \equiv \bigoplus_{j=1}^C \balpha^{(j)}.
\end{eqn}
Then we can use \thmref{fpe-sde:corr:fpe-sde-complex} with the drift vector
\begin{eqn}
	\avec = \bigoplus_{j=1}^C \avec^{(j)},
\end{eqn}
the cogradient vector
\begin{eqn}
	\vcwd_{\balpha} = \bigoplus_{j=1}^C \vcwd_{\balpha^{(j)}},
\end{eqn}
and the noise matrix
\begin{eqn}
	B = \begin{pmatrix}
		B^{(1)} \\ \vdots \\ B^{(C)}
	\end{pmatrix}.
\end{eqn}
This gives us \abbrev{sde}s in the It\^o form
\begin{eqn}
	\upd\balpha = \avec \upd t + B \upd\Zvec,
\end{eqn}
where $d\Zvec$ is an $L$-dimensional standard complex-valued Wiener process.
Splitting this equation for different components, we get the It\^o part of the theorem statement.
Substituting $B$ into the expression for the Stratonovich term:
\begin{eqn}
	s_i^{(j)}
	& = \frac{1}{2} \Trace{
		\begin{pmatrix} (B^{(1)})^H & \cdots & (B^{(C)})^H \end{pmatrix}
		\begin{pmatrix}
			\vcwd_{(\balpha^{(1)})^*} \\
			\vdots \\
			\vcwd_{(\balpha^{(C)})^*}
		\end{pmatrix}
		\begin{pmatrix} 0 & \cdots & \evec_i^T & \cdots & 0 \end{pmatrix}
		\begin{pmatrix}
			B^{(1)} \\
			\vdots \\
			B^{(C)}
		\end{pmatrix}
	}.
\end{eqn}
Multiplying the matrices successively, we get
\begin{eqn}
	& = \frac{1}{2} \Trace{
		\begin{pmatrix} (B^{(1)})^H & \cdots & (B^{(C)})^H \end{pmatrix}
		\begin{pmatrix}
			\vcwd_{(\balpha^{(1)})^*} \evec_i^T B^{(j)} \\
			\vdots \\
			\vcwd_{(\balpha^{(C)})^*} \evec_i^T B^{(j)}
		\end{pmatrix}
	} \\
	& = \frac{1}{2} \sum_{k=1}^C \Trace{
		(B^{(k)})^H
		\vcwd_{(\balpha^{(k)})^*}
		\evec_i^T
		B^{(j)}
	},
\end{eqn}
which is the expression from the theorem statement.
\end{proof}

Most of the time we will deal with \abbrev{fpe}s in a functional form, so we will reformulate the correspondence once again, now using functional derivatives.

\begin{theorem}
\label{thm:fpe-sde:corr:fpe-sde-func}
	The \abbrev{fpe} in a functional form
	\begin{eqn*}
		\frac{\upd W}{\upd t}
		={} & \int \upd\xvec \left(
			- \sum_{j=1}^C \frac{\fdelta}{\fdelta f_j} \mathcal{A}_j W
			- \sum_{j=1}^C \frac{\fdelta}{\fdelta f_j^*} \mathcal{A}_j^* W \right. \\
		& \left. + \sum_{j=1}^C \sum_{k=1}^C \frac{\fdelta^2}{\fdelta f_j^* \fdelta f_k}
				\sum_{l=1}^L \mathcal{B}_{kl} \mathcal{B}_{jl}^* W
		\right)
	\end{eqn*}
	is equivalent to the set of \abbrev{sde}s in the It\^o form
	\begin{eqn*}
		\upd f_j = \mathcal{P}_{\restbasis_j} \left[
			\mathcal{A}_j \upd t
			+ \sum_{l=1}^L \mathcal{B}_{jl} \upd Q_l
		\right],
	\end{eqn*}
	or the set of \abbrev{sde}s in the Stratonovich form
	\begin{eqn*}
		\upd f_j = \mathcal{P}_{\restbasis_j} \left[
			(\mathcal{A}_j - \mathcal{S}_j) \upd t
			+ \sum_{l=1}^L \mathcal{B}_{jl} \upd Q_l
		\right],
	\end{eqn*}
	where
	\begin{eqn*}
		\mathcal{S}_j = \frac{1}{2} \sum_{k=1}^C \sum_{l=1}^L
			\mathcal{B}_{kl}^*
			\frac{\fdelta}{\fdelta f_k^*}
			\mathcal{B}_{jl}.
	\end{eqn*}
	Here $f_j \in \mathbb{F}_{\mathbb{M}_j}$, $\mathcal{A}_j \equiv \mathcal{A}_j[\fvec]$ and $\mathcal{B}_{jl} \equiv \mathcal{B}_{jl}[\fvec]$ are functional operators, $W \equiv W[\fvec]$ is a probability functional, and $L$ is the number of noise sources.
	The standard functional Wiener processes $Q_l$ are the compositions of standard complex-valued Wiener processes:
	\begin{eqn*}
		Q_l = \sum_{\nvec \in \fullbasis} \phi_{\nvec} Z_{l,\nvec}.
	\end{eqn*}
\end{theorem}
\begin{proof}
Expanding the functional derivatives according to \defref{func-calculus:func-diff} with $f_j = \sum_{\nvec \in \restbasis_j} \phi_{j,\nvec} \alpha_{j,\nvec}$:
\begin{eqn}
	\frac{\upd W}{\upd t}
	={} & \left(
		- \sum_{j=1}^C \sum_{\nvec \in \restbasis_j}
			\frac{\cwd}{\cwd \alpha_{j,\nvec}}
			\int \upd\xvec\, \phi_{j,\nvec}^* \mathcal{A}_j W
		- \sum_{j=1}^C \sum_{\nvec \in \restbasis_j}
			\frac{\cwd}{\cwd \alpha_{j,\nvec}^*}
			\int \upd\xvec\, \phi_{j,\nvec} \mathcal{A}_j^* W
		\right. \\
	&	\left. + \sum_{j=1}^C \sum_{k=1}^C
			\sum_{\mvec \in \restbasis_j, \nvec \in \restbasis_k}
			\frac{\cwd}{\cwd \alpha_{j,\mvec}^*}
			\frac{\cwd}{\cwd \alpha_{k,\nvec}}
			\int \upd\xvec
			\phi_{j,\mvec} \phi_{k,\nvec}^*
			\sum_{l=1}^L \mathcal{B}_{jl}^* \mathcal{B}_{kl} W
	\right).
\end{eqn}
The diffusion term has to be transformed in order to conform to \thmref{fpe-sde:corr:mc-fpe-sde}:
\begin{eqn}
	\int \upd\xvec \phi_{j,\mvec} \phi_{k,\nvec}^* \sum_{l=1}^L
		\mathcal{B}_{kl} \mathcal{B}_{jl}^*
	& = \int \upd\xvec \int \upd\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{l=1}^L \mathcal{B}_{jl}^{\prime *} \mathcal{B}_{kl}
			\delta(\xvec - \xvec^\prime) \\
	& = \int \upd\xvec \int \upd\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{l=1}^L \mathcal{B}_{jl}^{\prime *} \mathcal{B}_{kl}
			\sum_{\pvec \in \fullbasis} \phi_{\pvec}^{\prime*} \phi_{\pvec} \\
	& = \sum_{l=1}^L \sum_{\pvec \in \fullbasis}
		\int \upd\xvec\,
			\phi_{j,\mvec} \mathcal{B}_{jl}^* \phi_{\pvec}^*
		\int \upd\xvec\,
			\phi_{k,\nvec}^* \mathcal{B}_{kl} \phi_{\pvec}.
\end{eqn}
Note that we did not specify the index of the full basis used to expand the delta function.
It can be any orthonormal and complete basis, in particular one of $\fullbasis_j$~--- this will not change the result.

Now we have the \abbrev{fpe} in the form required by \thmref{fpe-sde:corr:mc-fpe-sde} with
\begin{eqn}
	a_{\mvec}^{(j)}
	= \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{A}_j,\,
	\mvec \in \restbasis_j,
\end{eqn}
and
\begin{eqn}
\label{eqn:fpe-sde:corr:func-noise-matrix}
	B_{\mvec,(\pvec,l)}^{(j)}
	= \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{B}_{jl} \phi_{\pvec},\,
	\mvec \in \restbasis_j, \pvec \in \fullbasis, l \in [1 \ldots L].
\end{eqn}
Note that the columns of $B$ are enumerated using the compound index $\pvec,l$.

Therefore, the initial \abbrev{fpe} is equivalent to the set of \abbrev{sde}s in the It\^o form
\begin{eqn}
	\upd\alpha_{\mvec}^{(j)}
	= \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{A}_j \upd t
	+ \sum_{\pvec \in \fullbasis, l \in [1 \ldots L]}
		\int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{B}_{jl} \phi_{\pvec} \upd Z_{\pvec,l}.
\end{eqn}
Multiplying by $\phi_{j,\mvec}^\prime$ and grouping by component:
\begin{eqn}
	\sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \upd\alpha_{\mvec}^{(j)}
	={} & \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \int \upd\xvec\, \phi_{j,\mvec}^* \mathcal{A}_j \upd t \\
	& + \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \int \upd\xvec\, \phi_{j,\mvec}^*
		\sum_{l=1}^L \sum_{\pvec \in \fullbasis}
			\mathcal{B}_{jl} \phi_{\pvec} \upd Z_{\pvec,l}.
\end{eqn}
Recognising \defref{func-calculus:projector} of the projection operator:
\begin{eqn}
	\upd f_j
	= \proj{\restbasis_j} \left[
		\mathcal{A}_j \upd t
		+ \sum_{l=1}^L \mathcal{B}_{jl}
			\sum_{\pvec \in \fullbasis} \phi_{\pvec} \upd Z_{\pvec,l}
	\right].
\end{eqn}
Defining the standard functional Wiener process as $Q_l = \sum_{\pvec \in \fullbasis} \phi_{\pvec} Z_{\pvec,l}$:
\begin{eqn}
	\upd f_c
	= \proj{\restbasis_j} \left[
		\mathcal{A}_j \upd t
		+ \sum_{l=1}^L \mathcal{B}_{jl} \upd Q_l
	\right].
\end{eqn}

Performing the same multiplication and summation on the Stratonovich term from \thmref{fpe-sde:corr:mc-fpe-sde}:
\begin{eqn}
	\mathcal{S}_j
	= \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime s_{\mvec}^{(j)}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \sum_{k=1}^C \Trace{
		(B^{(k)})^H \vcwd_{(\balpha^{(k)})^*} \evec_{\mvec}^T B^{(j)}
	}.
\end{eqn}
Transforming the trace to a summation:
\begin{eqn}
	\mathcal{S}_j
	= \frac{1}{2} \sum_{\mvec \in \restbasis_c} \phi_{j,\mvec}^\prime \sum_{k=1}^C
		\sum_{\nvec \in \restbasis_k} \sum_{l=1}^L \sum_{\pvec \in \fullbasis}
			(B_{\nvec (\pvec,l)}^{(k)})^*
			\frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
			B_{\mvec (\pvec,l)}^{(j)}.
\end{eqn}
Using the multimode form~\eqnref{fpe-sde:corr:func-noise-matrix} of the noise matrix:
\begin{eqn}
	\mathcal{S}_j
	= \frac{1}{2} \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime \sum_{k=1}^C
		\sum_{\nvec \in \restbasis_k} \sum_{l=1}^L \sum_{\pvec \in \fullbasis}
			\int \upd\xvec\, \phi_{k,\nvec} \mathcal{B}_{kl}^* \phi_{\pvec}^*
			\int \upd\xvec\, \phi_{j,\mvec}^*
				\frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
				\mathcal{B}_{jl} \phi_{\pvec}.
\end{eqn}
Substituting $\sum_{\pvec \in \fullbasis} \phi_{\pvec}^* \phi_{\pvec} = \delta(\xvec - \xvec^\prime)$:
\begin{eqn}
	\mathcal{S}_j
	= \frac{1}{2} \sum_{\mvec \in \restbasis_j} \phi_{j,\mvec}^\prime
		\sum_{k=1}^C \sum_{\nvec \in \restbasis_k} \sum_{l=1}^L
			\int \upd\xvec\,
				\phi_{k,\nvec} \mathcal{B}_{kl}^*
				\phi_{j,\mvec}^* \frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
				\mathcal{B}_{jl}.
\end{eqn}
Recognising the projection transformation and the functional differential:
\begin{eqn}
	\mathcal{S}_j
	& = \proj{\restbasis_j} \left[
		\frac{1}{2} \sum_{k=1}^C \sum_{\nvec \in \restbasis_k} \sum_{l=1}^L
			\phi_{k,\nvec} \mathcal{B}_{kl}^*
			\frac{\cwd}{\cwd (\alpha_{\nvec}^{(k)})^*}
			\mathcal{B}_{jl}
	\right] \\
	& = \proj{\restbasis_j} \left[
		\frac{1}{2} \sum_{k=1}^C \sum_{l=1}^L
		\mathcal{B}_{kl}^*
		\frac{\fdelta}{\fdelta f_k^*}
		\mathcal{B}_{jl}
	\right].
	\qedhere
\end{eqn}
\end{proof}

Alternatively, the \abbrev{fpe} from the above theorem can be expressed in a short matrix form.
The \abbrev{fpe} in this case is
\begin{eqn}
	\frac{dW}{dt}
	= \int d\xvec \left(
		- \vfdelta_{\fvec} \cdot \mathbfcal{A} W
		- \vfdelta_{\fvec^*} \cdot \mathbfcal{A}^* W
		+ \Trace{ \vfdelta_{\fvec^*} \vfdelta_{\fvec}^T \mathcal{B} \mathcal{B}^H } W
	\right),
\end{eqn}
where the functional cogradient $\vfdelta_{\fvec} = \left( \fdelta/\fdelta f_1 \ldots \fdelta/\fdelta f_C \right)$, $\mathbf{\mathcal{A}}$ is a vector of $C$ functional operators, and $\mathcal{B}$ is a matrix of $C \times L$ functional operators.
Such \abbrev{fpe} is equivalent to the matrix \abbrev{sde} in the Stratonovich form:
\begin{eqn}
	\upd \fvec = \mathbfcal{P} \left[
		\left( \mathbfcal{A} - \mathbfcal{S} \right) \upd t
		+ \mathcal{B} \upd \Qvec
	\right],
\end{eqn}
with the Stratonovich term
\begin{eqn}
	\mathbfcal{S}_j
	= \frac{1}{2} \Trace{ \mathcal{B}^H \vfdelta_{\fvec^*} \evec_j^T \mathcal{B} },
\end{eqn}
where $\mathbfcal{P}^T \equiv (\proj{\restbasis_1} \ldots \proj{\restbasis_C})$ is a vector of projection operators, and $\Qvec^T \equiv (Q_1 \ldots Q_C)$ is a vector of standard functional Wiener processes.
