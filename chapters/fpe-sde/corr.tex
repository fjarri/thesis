% =============================================================================
\section{Correspondences}
% =============================================================================

\begin{lemma}[FPE--SDEs correspondence in convenient form.]
\label{lmm:fpe-sde:corr:fpe-sde-real}
	If $\zvec^T \equiv (z_1 \ldots z_M)$ is a set of real variables, Fokker-Planck equation
	\begin{eqn*}
		\frac{dW}{dt}
		= -\bpartial_{\zvec}^T \cdot \avec W
		+ \frac{1}{2} \Trace{ \bpartial_{\zvec} \bpartial_{\zvec}^T B B^T } W
	\end{eqn*}
	is equivalent to a set of stochastic differential equations in It\^{o} form
	\begin{eqn*}
		d\zvec = \avec dt + B d\Zvec
	\end{eqn*}
	and to a set of stochastic differential equations in Stratonovich form
	\begin{eqn*}
		d\zvec = (\avec - \svec)dt + B d\Zvec,
	\end{eqn*}
	where the noise-induced (or spurious) drift vector $\svec$ has elements
	\begin{eqn*}
		s_i
		= \frac{1}{2} \sum_{k,j} B_{kj} \frac{\partial}{\partial z_k} B_{ij}
		= \frac{1}{2} \Trace{B^T \bpartial_z \evec_i^T B},
	\end{eqn*}
	$\evec_i$ being the unit vector with elements $(\evec_i)_j = \delta_{ij}$.
	\todo{Is there a better way to express $\svec$ in terms of matrices?}
	Here $W \equiv W(\zvec)$ is a probability distribution, $\avec \equiv \avec(\zvec)$ is a vector function, $B \equiv B(\zvec)$ is a matrix function ($B$ having size $M \times L$, where $L$ corresponds to the number of noise sources), $\bpartial_{\zvec}^T \equiv (\partial_{z_1} \ldots \partial_{z_M})$ is a vector differential, and $\Zvec$ is a standard $L$-dimensional Wiener process.
\end{lemma}
\begin{proof}
For details see~\cite{Risken1996}, sections 3.3 and 3.4.
\todo{Consider the case of colored noise (\cite{Risken1996}, 3.1 and appendix A).}
\end{proof}

\begin{theorem}
\label{thm:fpe-sde:corr:fpe-sde-complex}
	If $\balpha^T \equiv (\alpha_1 \ldots \alpha_M)$ is a set of complex variables,
	Fokker-Planck equation
	\begin{eqn*}
		\frac{dW}{dt}
		= -\bpartial_{\balpha}^T \avec W - \bpartial_{\balpha^*}^T \avec^* W
		+ \Trace{ \bpartial_{\balpha^*} \bpartial_{\balpha}^T B B^H } W
	\end{eqn*}
	is equivalent to a set of stochastic differential equations in It\^{o} form
	\begin{eqn*}
		d\balpha = \avec dt + B d\Zvec,
	\end{eqn*}
	or to Stratonovich form
	\begin{eqn*}
		d\balpha = (\avec - \svec) dt + B d\Zvec,
	\end{eqn*}
	where noise-induced drift term is
	\begin{eqn*}
		s_j = \frac{1}{2} \Trace{ B^H \bpartial_{\balpha^*} \evec_j^T B },
	\end{eqn*}
	and $\Zvec = (\mathbf{X} + i\mathbf{Y}) / \sqrt{2}$ is an $L$-dimensional complex-valued Wiener process,
	containing two standard $L$-dimensional Wiener processes $\mathbf{X}$ and $\mathbf{Y}$.
\end{theorem}
\begin{proof}
Let us expand the FPE using real values $\balpha = \mathbf{x} + i \mathbf{y}$, $\avec = \mathbf{u} + i \mathbf{v}$, $B = F + iG$, $\bpartial_{\balpha} = (\bpartial_{\mathbf{x}} - i \bpartial_{\mathbf{y}}) / 2$.
Thus
\begin{eqn}
	\frac{dW}{dt}
	={} & - \bpartial_{\mathbf{x}}^T \mathbf{u} W
	- \bpartial_{\mathbf{y}}^T \mathbf{v} W
	+ \frac{1}{4} \Trace{
		(\bpartial_{\mathbf{x}} \bpartial_{\mathbf{x}}^T
			+ \bpartial_{\mathbf{y}} \bpartial_{\mathbf{y}}^T)
		(F F^T + G G^T) \right. \\
	& \left. - (\bpartial_{\mathbf{x}} \bpartial_{\mathbf{y}}^T
			- \bpartial_{\mathbf{y}} \bpartial_{\mathbf{x}}^T)
		(F G^T - G F^T)
	} W \\
	& + \frac{i}{4} \Trace{
		(\bpartial_{\mathbf{x}} \bpartial_{\mathbf{x}}^T
			+ \bpartial_{\mathbf{y}} \bpartial_{\mathbf{y}}^T)
		(F G^T - G F^T)
	} W \\
	& + \frac{i}{4} \Trace{
		(\bpartial_{\mathbf{x}} \bpartial_{\mathbf{y}}^T
			- \bpartial_{\mathbf{y}} \bpartial_{\mathbf{x}}^T)
		(F F^T + G G^T)
	} W.
\end{eqn}
Since $F F^T + G G^T$ and $\bpartial_{\mathbf{x}} \bpartial_{\mathbf{x}}^T + \bpartial_{\mathbf{y}} \bpartial_{\mathbf{y}}^T$ are symmetric matrices, and $F G^T - G F^T$ and $\bpartial_{\mathbf{x}} \bpartial_{\mathbf{y}}^T - \bpartial_{\mathbf{y}} \bpartial_{\mathbf{x}}^T$ are antisymmetric, corresponding traces are equal to zero, which gives us FPE in real variables
\begin{eqn}
	\frac{dW}{dt}
	={} & - \bpartial_{\mathbf{x}}^T \mathbf{u} W
	- \bpartial_{\mathbf{y}}^T \mathbf{v} W
	+ \frac{1}{4} \Trace{
		(\bpartial_{\mathbf{x}} \bpartial_{\mathbf{x}}^T
			+ \bpartial_{\mathbf{y}} \bpartial_{\mathbf{y}}^T)
		(F F^T + G G^T) \right. \\
	& \left. - (\bpartial_{\mathbf{x}} \bpartial_{\mathbf{y}}^T
			- \bpartial_{\mathbf{y}} \bpartial_{\mathbf{x}}^T)
		(F G^T - G F^T)
	} W.
\end{eqn}

In order to use \lmmref{fpe-sde:corr:fpe-sde-real},
we need to join variables $\mathbf{x}$ and $\mathbf{y}$ into the one variable vector $\zvec^T \equiv \mathbf{x}^T \oplus \mathbf{y}^T$.
This will give us an equation identical to one from the lemma, with the drift vector $\tilde{\avec}^T \equiv \mathbf{u}^T \oplus \mathbf{v}^T$ and the diffusion matrix
\begin{eqn}
	\tilde{B} \tilde{B}^T \equiv \frac{1}{2} \begin{pmatrix}
		F F^T + G G^T & F G^T - G F^T \\
		G F^T - F G^T & F F^T + G G^T
	\end{pmatrix},
\end{eqn}
which gives a noise matrix
\begin{eqn}
	\tilde{B} = \frac{1}{\sqrt{2}} \begin{pmatrix}
		F & -G \\
		G & F
	\end{pmatrix}.
\end{eqn}
Therefore the equivalent SDEs in It\^{o} form are
\begin{eqn}
	d\zvec = \tilde{\avec} dt + \tilde{B} d\tilde{\Zvec},
\end{eqn}
where $d\tilde{\Zvec}^T \equiv d\mathbf{X}^T \oplus d\mathbf{Y}^T$.
Returning to our previous variables:
\begin{eqn}
	d\mathbf{x} & = \mathbf{u} dt + \frac{1}{\sqrt{2}} F d\mathbf{X} - \frac{1}{\sqrt{2}} G d\mathbf{Y} \\
	d\mathbf{y} & = \mathbf{v} dt + \frac{1}{\sqrt{2}} G d\mathbf{X} + \frac{1}{\sqrt{2}} F d\mathbf{Y}.
\end{eqn}
Multiplying the second equation by $i$ and adding it to the first one:
\begin{eqn}
	d\balpha = \avec dt + \frac{1}{\sqrt{2}} (F + iG) (d\mathbf{X} + id\mathbf{Y}),
\end{eqn}
which leads to the It\^{o} part of the lemma statement.
\begin{eqn}
	d\balpha = \avec dt + B d\Zvec.
\end{eqn}

Noise-induced drift term in Stratonovich case can be calculated as
\begin{eqn}
	s_j^{(x)}
	& = \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\bpartial_{\mathbf{x}} \\
			\bpartial_{\mathbf{y}}
		\end{pmatrix}
		\begin{pmatrix}
			\evec_j^T & 0
		\end{pmatrix}
		\begin{pmatrix}
			F & -G \\ G & F
		\end{pmatrix}
	} \\
	& = \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\bpartial_{\mathbf{x}} \\
			\bpartial_{\mathbf{y}}
		\end{pmatrix}
		\begin{pmatrix}
			\evec_j^T F & - \evec_j^T G
		\end{pmatrix}
	} \\
	& = \frac{1}{4} \Trace{
		\begin{pmatrix}
			F^T & G^T \\ -G^T & F^T
		\end{pmatrix}
		\begin{pmatrix}
			\bpartial_{\mathbf{x}} \evec_j^T F & - \bpartial_{\mathbf{x}} \evec_j^T G \\
			\bpartial_{\mathbf{y}} \evec_j^T F & - \bpartial_{\mathbf{y}} \evec_j^T G
		\end{pmatrix}
	} \\
	& = \frac{1}{4} \left(
		\Trace{ F^T \bpartial_{\mathbf{x}} \evec_j^T F }
		+ \Trace{ G^T \bpartial_{\mathbf{y}} \evec_j^T F }
		+ \Trace{ G^T \bpartial_{\mathbf{x}} \evec_j^T G }
		- \Trace{ F^T \bpartial_{\mathbf{y}} \evec_j^T G }
	\right).
\end{eqn}
Similarly,
\begin{eqn}
	s_j^{(y)}
	= \frac{1}{4} \left(
		\Trace{ F^T \bpartial_{\mathbf{x}} \evec_j^T G }
		+ \Trace{ G^T \bpartial_{\mathbf{y}} \evec_j^T G }
		- \Trace{ G^T \bpartial_{\mathbf{x}} \evec_j^T F }
		+ \Trace{ F^T \bpartial_{\mathbf{y}} \evec_j^T F }
	\right).
\end{eqn}
Therefore the final term in complex-valued SDEs is
\begin{eqn}
	s_j
	= s_j^{(x)} + i s_j^{(y)}
	= \frac{1}{2} \Trace{ B^H \bpartial_{\balpha^*} \evec_j^T B }.
	\qedhere
\end{eqn}
\end{proof}

Note the asymmetry in the expression for Stratonovich term: if $B = B(\alpha)$, then $\mathbf{s} \equiv 0$.
It is initially caused by the asymmetry in the target SDEs.
Truly general form of FPE would be
\begin{eqn}
	\frac{dW}{dt}
	={} & - \Real \left( \bpartial_{\balpha}^T \avec \right) W
	+ \Trace{ \bpartial_{\balpha^*} \bpartial_{\balpha}^T B_1 B_1^H } W
	+ \Trace{ \bpartial_{\balpha^*} \bpartial_{\balpha}^T B_2 B_2^H } W \\
	& + 2 \Real \left(
		\Trace{ \bpartial_{\balpha} \bpartial_{\balpha}^T B_1 B_2^T }
		+ \Trace{ \bpartial_{\balpha} \bpartial_{\balpha}^T B_2 B_1^T }
	\right) W,
\end{eqn}
which corresponds to the system of SDEs
\begin{eqn}
	d\balpha = (\avec - \svec) dt + B_1 d\Zvec + B_2 d\Zvec^*,
\end{eqn}
with
\begin{eqn}
	s_j = \frac{1}{2} \left(
		\Trace{ B_1^H \bpartial_{\balpha^*} \evec_j^T B_1 }
		+ \Trace{ B_2^H \bpartial_{\balpha^*} \evec_j^T B_2 }
		+ \Trace{ B_1^T \bpartial_{\balpha} \evec_j^T B_2 }
		+ \Trace{ B_2^T \bpartial_{\balpha} \evec_j^T B_1 }
	\right).
\end{eqn}

In the theorem above we limit the space of possible SDEs to those with $B_2 \equiv 0$, leading to the asymmetry.


\begin{theorem}[Multi-component reformulation of \thmref{fpe-sde:corr:fpe-sde-complex}]
\label{thm:fpe-sde:corr:mc-fpe-sde}
	If $\balpha^{(c)},\, c = 1..C$ are $C$ sets of complex variables $\balpha^{(c)} \equiv (\alpha_1^{(c)} \ldots \alpha_{M_c}^{(c)})$,
	then Fokker-Planck equation
	\begin{eqn*}
		\frac{dW}{dt}
		= - \sum_{c=1}^C \bpartial_{\balpha^{(c)}}^T \avec^{(c)} W
		- \sum_{c=1}^C \bpartial_{(\balpha^{(c)})^*}^T (\avec^{(c)})^* W
		+ \sum_{m=1}^C \sum_{n=1}^C
			\Trace{
				\bpartial_{(\balpha^{(m)})^*}
				\bpartial_{\balpha^{(n)}}^T
				B^{(n)} (B^{(m)})^H
			} W
	\end{eqn*}
	is equivalent to a set of stochastic differential equations in It\^{o} form
	\begin{eqn*}
		d\balpha^{(c)} = \avec^{(c)} dt + B^{(c)} d\Zvec,\, c = 1..C
	\end{eqn*}
	or to Stratonovich form
	\begin{eqn*}
		d\balpha^{(c)} = (\avec^{(c)} - \svec^{(c)}) dt + B^{(c)} d\Zvec,
	\end{eqn*}
	where noise-induced drift term is
	\begin{eqn*}
		s_j^{(c)} = \frac{1}{2} \sum_{n=1}^C
			\Trace{ (B^{(n)})^H \bpartial_{(\balpha^{(n)})^*} \evec_j^T B^{(c)} },
	\end{eqn*}
	and $d\Zvec$ is an $L$-dimensional complex-valued Wiener process.
\end{theorem}
\begin{proof}
Let us join all variable sets $\balpha^{(c)}$ into one set
\begin{eqn}
	\balpha \equiv \bigoplus_{c=1}^C \balpha^{(c)}.
\end{eqn}
Then we can use \thmref{fpe-sde:corr:fpe-sde-complex} with drift vector
\begin{eqn}
	\avec = \bigoplus_{c=1}^C \avec^{(c)},
\end{eqn}
differentials vector
\begin{eqn}
	\bpartial_{\balpha} = \bigoplus_{c=1}^C \bpartial_{\balpha^{(c)}},
\end{eqn}
and noise matrix
\begin{eqn}
	B = \begin{pmatrix}
		B^{(1)} \\ \vdots \\ B^{(C)}
	\end{pmatrix}.
\end{eqn}
This gives us SDEs in It\^{o} form
\begin{eqn}
	d\balpha = \avec dt + B d\Zvec,
\end{eqn}
where $d\Zvec$ is an $L$-dimensional complex-valued Wiener process.
Splitting this equation for different components, we get the statement of the lemma.
Stratonovich variant is obtained in the same way.
Noise-induced drift term requires some work:
\begin{eqn}
	s_j^{(c)}
	& = \frac{1}{2} \Trace{
		\begin{pmatrix} (B^{(1)})^H & \cdots & (B^{(C)})^H \end{pmatrix}
		\begin{pmatrix}
			\bpartial_{(\balpha^{(1)})^*} \\
			\vdots \\
			\bpartial_{(\balpha^{(C)})^*}
		\end{pmatrix}
		\begin{pmatrix} 0 & \cdots & \evec_j^T & \cdots & 0 \end{pmatrix}
		\begin{pmatrix}
			B^{(1)} \\
			\vdots \\
			B^{(C)}
		\end{pmatrix}
	} \\
	& = \frac{1}{2} \Trace{
		\begin{pmatrix} (B^{(1)})^H & \cdots & (B^{(C)})^H \end{pmatrix}
		\begin{pmatrix}
			\bpartial_{(\balpha^{(1)})^*} \evec_j^T B^{(c)} \\
			\vdots \\
			\bpartial_{(\balpha^{(C)})^*} \evec_j^T B^{(c)}
		\end{pmatrix}
	} \\
	& = \frac{1}{2} \sum_{n=1}^C \Trace{
		(B^{(n)})^H
		\bpartial_{(\balpha^{(n)})^*}
		\evec_j^T
		B^{(c)}
	}.
\end{eqn}
\end{proof}

\begin{theorem}
\label{thm:fpe-sde:corr:fpe-sde-func}
	Functional FPE
	\begin{eqn*}
		\frac{dW}{dt}
		= \int d\xvec \left(
			- \sum_{j=1}^C \frac{\delta}{\delta \Psi_j} \mathcal{A}^{(j)}
			- \sum_{j=1}^C \frac{\delta}{\delta \Psi_j^*} (\mathcal{A}^{(j)})^*
			+ \sum_{j=1}^C \sum_{k=1}^C \frac{\delta^2}{\delta \Psi_j^* \delta \Psi_k}
				\sum_{\lvec} \mathcal{B}_{\lvec}^{(k)} (\mathcal{B}_{\lvec}^{(j)})^*
		\right) W
	\end{eqn*}
	\todo{Or, in matrix form
	\begin{eqn*}
		\frac{dW}{dt}
		= \int d\xvec \left(
			- 2 \Real \left( \bdelta_{\bPsi} \cdot \vec{\mathcal{A}} \right)
			+ \Trace{ \bdelta_{\bPsi^*} \bdelta_{\bPsi}^T \mathcal{B} \mathcal{B}^H }
		\right) W
	\end{eqn*}
	}
	is equivalent to the set of SDEs in It\^{o} form
	\begin{eqn*}
		d\Psi_j = \mathcal{P}_{\restbasis_j} \left[
			\mathcal{A}^{(j)} dt + \sum_{\lvec} \mathcal{B}_{\lvec}^{(j)} dQ_{\lvec}
		\right],
	\end{eqn*}
	or in Stratonovich form
	\begin{eqn*}
		d\Psi_j = \mathcal{P}_{\restbasis_j} \left[
			(\mathcal{A}^{(j)} - \mathcal{S}^{(j)}) dt + \sum_{\lvec} \mathcal{B}_{\lvec}^{(j)} dQ_{\lvec}
		\right],
	\end{eqn*}
	where
	\begin{eqn*}
		\mathcal{S}^{(j)} = \frac{1}{2} \sum_{n=1}^C \sum_{\lvec}
			(\mathcal{B}_{\lvec}^{(n)})^*
			\frac{\delta}{\delta \Psi_n^*}
			\mathcal{B}_{\lvec}^{(j)},
	\end{eqn*}
	and $Q_{\lvec}$ is a functional Wiener process:
	\begin{eqn*}
		Q_{\lvec} = \sum_{\nvec \in \fullbasis} \phi_{\nvec} Z_{\lvec,\nvec}.
	\end{eqn*}
\end{theorem}
\begin{proof}
Considering $\Psi_j = \sum_{\nvec \in \restbasis_j} \phi_{j,\nvec} \alpha_{j,\nvec}$ and replacing functional derivatives with ordinary ones:
\begin{eqn}
	\frac{dW}{dt}
	={} & \left(
		- \sum_{j=1}^C \sum_{\nvec \in \restbasis_j}
			\frac{\partial}{\partial \alpha_{j,\nvec}}
			\int d\xvec \phi_{j,\nvec}^* \mathcal{A}^{(j)}
		- \sum_{j=1}^C \sum_{\nvec \in \restbasis_j}
			\frac{\partial}{\partial \alpha_{j,\nvec}^*}
			\int d\xvec \phi_{j,\nvec} (\mathcal{A}^{(j)})^*
		\right. \\
	&	\left. + \sum_{j=1}^C \sum_{k=1}^C
			\sum_{\mvec \in \restbasis_j, \nvec \in \restbasis_k}
			\frac{\partial}{\partial \alpha_{j,\mvec}^*}
			\frac{\partial}{\partial \alpha_{k,\nvec}}
			\int d\xvec
			\phi_{j,\mvec} \phi_{k,\nvec}^*
			\sum_{\lvec} \mathcal{B}_{\lvec}^{(j)} (\mathcal{B}_{\lvec}^{(k)})^*
	\right) W.
\end{eqn}
The diffusion term has to be transformed in order to conform to \thmref{fpe-sde:corr:mc-fpe-sde}:
\begin{eqn}
	\int d\xvec \phi_{j,\mvec} \phi_{k,\nvec}^* \sum_{\lvec} \mathcal{B}_{\lvec}^{(k)} (\mathcal{B}_{\lvec}^{(j)})^*
	& = \int d\xvec \int d\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{\lvec} (\mathcal{B}_{\lvec}^{(j)})^{\prime *} \mathcal{B}_{\lvec}^{(k)}
			\delta(\xvec - \xvec^\prime) \\
	& = \int d\xvec \int d\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{\lvec} (\mathcal{B}_{\lvec}^{(j)})^{\prime *} \mathcal{B}_{\lvec}^{(k)}
			\sum_{\pvec \in \fullbasis} \phi_{\pvec}^{\prime*} \phi_{\pvec} \\
	& = \sum_{\pvec \in \fullbasis, \lvec}
		\int d\xvec
			\phi_{j,\mvec} (\mathcal{B}_{\lvec}^{(j)})^* \phi_{\pvec}^*
		\int d\xvec
			\phi_{k,\nvec}^* \mathcal{B}_{\lvec}^{(k)} \phi_{\pvec}
\end{eqn}
Note that we did not specify the index of the full basis used to expand the delta function.
It can be any orthonormal and complete basis, in particular one of $\fullbasis_j$, this will not change the result.

Now we have the FPE from \thmref{fpe-sde:corr:mc-fpe-sde} with
\begin{eqn}
	\avec_{\mvec}^{(c)} = \int d\xvec \phi_{c,\mvec}^* \mathcal{A}^{(c)},\,\mvec \in \restbasis_c
\end{eqn}
and
\begin{eqn}
\label{eqn:fpe-sde:corr:func-noise-matrix}
	B_{\mvec,(\nvec,\lvec)}^{(c)} = \int d\xvec \phi_{c,\mvec}^* \mathcal{B}_{\lvec}^{(c)} \phi_{\nvec},\,
	\mvec \in \restbasis_c, \nvec \in \fullbasis.
\end{eqn}
Note that columns of $B$ are enumerated using compound index $\nvec,\lvec$.

Therefore the initial FPE is equivalent to the set of SDEs in It\^{o} form
\begin{eqn}
	d\alpha_{\mvec}^{(c)}
	= \int d\xvec \phi_{c,\mvec}^* \mathcal{A}^{(c)} dt
	+ \sum_{\nvec \in \fullbasis, \lvec}
		\int d\xvec \phi_{c,\mvec}^* \mathcal{B}_{\lvec}^{(c)} \phi_{\nvec} dZ_{\nvec,\lvec}.
\end{eqn}
Multiplying by $\phi_{c,\mvec}^\prime$ and grouping by component:
\begin{eqn}
	\sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime d\alpha_{\mvec}^{(c)}
	= \sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime \int d\xvec \phi_{c,\mvec}^* \mathcal{A}^{(c)} dt
	+ \sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime \int d\xvec \phi_{c,\mvec}^*
		\sum_{\nvec \in \fullbasis, \lvec} \mathcal{B}_{\lvec}^{(c)} \phi_{\nvec} dZ_{\nvec,\lvec}.
\end{eqn}
Recognizing \defref{func-calculus:projector} of projection transformation:
\begin{eqn}
	d\Psi_c
	= \mathcal{P}_{\restbasis_c} \left[
		\mathcal{A}^{(c)} dt
		+ \sum_{\lvec} \mathcal{B}_{\lvec}^{(c)}
			\sum_{\nvec \in \fullbasis} \phi_{\nvec} dZ_{\nvec,\lvec}
	\right].
\end{eqn}
Defining functional Wiener process $Q_{\lvec} = \sum_{\nvec \in \fullbasis} \phi_{\nvec} dZ_{\nvec,\lvec}$:
\begin{eqn}
	d\Psi_c
	= \mathcal{P}_{\restbasis_c} \left[
		\mathcal{A}^{(c)} dt
		+ \sum_{\lvec} \mathcal{B}_{\lvec}^{(c)} dQ_{\lvec}
	\right].
\end{eqn}

Performing the same multiplication and summation on Stratonovich term from \thmref{fpe-sde:corr:mc-fpe-sde}:
\begin{eqn}
	\mathcal{S}^{(c)}
	= \sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime s_{\mvec}^{(c)}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime \sum_{n=1}^C \Trace{
		(B^{(n)})^H \bpartial_{(\balpha^{(n)})^*} \evec_{\mvec}^T B^{(c)}
	}.
\end{eqn}
Transforming trace to summation:
\begin{eqn}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime \sum_{n=1}^C
		\sum_{\jvec \in \restbasis_n} \sum_{\pvec \in \fullbasis, \lvec}
			(B_{\jvec (\pvec,\lvec)}^{(n)})^*
			\frac{\partial}{\partial (\alpha_{\jvec}^{(n)})^*}
			B_{\mvec (\pvec,\lvec)}^{(c)}.
\end{eqn}
Using the multimode form~\eqnref{fpe-sde:corr:func-noise-matrix} of the noise matrix:
\begin{eqn}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime \sum_{n=1}^C
		\sum_{\jvec \in \restbasis_n} \sum_{\pvec \in \fullbasis, \lvec}
			\int d\xvec \phi_{n,\jvec} (\mathcal{B}_{\lvec}^{(n)})^* \phi_{\pvec}^*
			\int d\xvec \phi_{c,\mvec}^*
				\frac{\partial}{\partial (\alpha_{\jvec}^{(n)})^*}
				\mathcal{B}_{\lvec}^{(c)} \phi_{\pvec}
\end{eqn}
Substituting $\sum_{\pvec \in \fullbasis} \phi_{\pvec}^* \phi_{\pvec} = \delta(\xvec - \xvec^\prime)$:
\begin{eqn}
	= \frac{1}{2} \sum_{\mvec \in \restbasis_c} \phi_{c,\mvec}^\prime
		\sum_{n=1}^C \sum_{\jvec \in \restbasis_n} \sum_{\lvec}
			\int d\xvec
				\phi_{n,\jvec} (\mathcal{B}_{\lvec}^{(n)})^*
				\phi_{c,\mvec}^* \frac{\partial}{\partial (\alpha_{\jvec}^{(n)})^*}
				\mathcal{B}_{\lvec}^{(c)}
\end{eqn}
Recognizing the projection transformation and the functional differential:
\begin{eqn}
	& = \mathcal{P}_{\restbasis_c} \left[
		\frac{1}{2} \sum_{n=1}^C \sum_{\jvec \in \restbasis_n} \sum_{\lvec}
			\phi_{n,\jvec} (\mathcal{B}_{\lvec}^{(n)})^*
			\frac{\partial}{\partial (\alpha_{\jvec}^{(n)})^*}
			\mathcal{B}_{\lvec}^{(c)}
	\right] \\
	& = \mathcal{P}_{\restbasis_c} \left[
		\frac{1}{2} \sum_{n=1}^C \sum_{\lvec}
		(\mathcal{B}_{\lvec}^{(n)})^*
		\frac{\delta}{\delta \Psi_n^*}
		\mathcal{B}_{\lvec}^{(c)}
	\right].
	\qedhere
\end{eqn}
\end{proof}
