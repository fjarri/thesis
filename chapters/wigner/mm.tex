% =============================================================================
\section{Multimode Wigner representation}
% =============================================================================


Single-mode \defref{formalism:sm-wigner:w-transformation} of Wigner transformation can be extended to the case of many modes.
In this section we will assume that mode identifiers belong to some set $\restbasis$ \todo{Has nothing to do with $\restbasis$ from multi-mode part, use some other symbol probably?}.

\begin{definition}
\label{def:formalism:mm-wigner:w-transformation}
	Let $\blambda$ and $\balpha$ be vectors of $\lambda_{\nvec}$ and $\alpha_{\nvec}$ values respectively,
	with $\nvec \in \restbasis$.
	Multi-mode Wigner transformation is
	\begin{eqn*}
		\mathcal{W}[\hat{A}]
		= \frac{1}{\pi^{2|\restbasis|}}
			\int d^2 \blambda
			\left(
				\prod_{\nvec \in \restbasis} \exp(-\lambda_{\nvec} \alpha_{\nvec}^* + \lambda_{\nvec}^* \alpha_{\nvec})
			\right)
			\Trace{
				\hat{A}
				\prod_{\nvec \in \restbasis} \hat{D}_{\nvec} (\lambda_{\nvec}, \lambda_{\nvec}^*)
			},
	\end{eqn*}
	where $\hat{D}_{\nvec} = \exp(\lambda_{\nvec} \hat{a}_{\nvec}^\dagger - \lambda_{\nvec}^* \hat{a}_{\nvec})$.
	It can be proved, same as in \thmref{formalism:sm-wigner:w-real} for the single-mode case, that $W[\hat{A}]$ is real if $\hat{A}$ is Hermitian.
	Multi-component Weyl transformation is
	\begin{eqn*}
		\mathcal{W}^{-1}[f]
		= \frac{1}{\pi^{|\restbasis|}} \int d^2 \bxi
			\left( \prod_{\nvec \in \restbasis} \hat{D}_{\nvec}^{\dagger}(\xi_{\nvec}, \xi_{\nvec}^*) \right)
			\int d^2 \bfeta
				\left( \prod_{\nvec \in \restbasis}
					\exp(-\eta_{\nvec} \xi_{\nvec}^* + \eta_{\nvec}^* \xi_{\nvec})
				\right) f(\bfeta, \bfeta^*).
	\end{eqn*}
\end{definition}

The equality $\mathcal{W}[\mathcal{W}^-1[f]] \equiv f$ is proved in the same way as in single-mode case.

Corresponding definitions of multimode characteristic function and Wigner function are

\begin{definition}
\label{def:formalism:mm-wigner:w-definition}
	\begin{eqn*}
		\chi_W (\blambda, \blambda^*)
		= \Trace{
			\hat{\rho}
			\prod_{\nvec \in \restbasis} \hat{D}_{\nvec} (\lambda_{\nvec}, \lambda_{\nvec}^*)
		},
	\end{eqn*}
	\begin{eqn*}
		W (\balpha, \balpha^*)
		\equiv \mathcal{W}[\hat{\rho}]
		= \frac{1}{\pi^{2|\restbasis|}} \int d^2 \blambda
			\left(
				\prod_{\nvec \in \restbasis}
				\exp(-\lambda_{\nvec} \alpha_{\nvec}^* + \lambda_{\nvec}^* \alpha_{\nvec})
			\right)
			\chi_W (\blambda, \blambda^*).
	\end{eqn*}
\end{definition}

\begin{theorem}[Multimode extension of \thmref{formalism:sm-wigner:correspondences}]
\label{thm:formalism:mm-wigner:correspondences}
	\begin{eqn*}
		\mathcal{W} [ \hat{a}_k \hat{A} ]
			& = \left( \alpha_k + \frac{1}{2} \frac{\partial}{\partial \alpha_k^*} \right)
				\mathcal{W}[\hat{A}],
		\quad
		\mathcal{W} [ \hat{a}_k^\dagger \hat{A} ]
			= \left( \alpha_k^* - \frac{1}{2} \frac{\partial}{\partial \alpha_k} \right)
				\mathcal{W}[\hat{A}], \\
		\mathcal{W} [ \hat{A} \hat{a}_k ]
			& = \left( \alpha_k - \frac{1}{2} \frac{\partial}{\partial \alpha_k^*} \right)
				\mathcal{W}[\hat{A}],
		\quad
		\mathcal{W} [ \hat{A} \hat{a}_k^\dagger ]
			= \left( \alpha_k^* + \frac{1}{2} \frac{\partial}{\partial \alpha_k} \right)
				\mathcal{W}[\hat{A}].
	\end{eqn*}
\end{theorem}
\begin{proof}
The procedure is the same as in \thmref{formalism:sm-wigner:correspondences}.
\end{proof}

\begin{lemma}[Multimode extension of \lmmref{formalism:sm-wigner:moments-from-chi}]
\label{lmm:formalism:mm-wigner:moments-from-chi}
	\begin{eqn*}
		\langle \symprod{ \prod_{\nvec \in \restbasis}
			\hat{a}_{\nvec}^{r_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{s_{\nvec}} } \rangle
		= \left.
			\left(
				\prod_{\nvec \in \restbasis}
				\left( \frac{\partial}{\partial \lambda_{\nvec}} \right)^{s_{\nvec}}
				\left( -\frac{\partial}{\partial \lambda_{\nvec}^*} \right)^{r_{\nvec}}
			\right)
			\chi_W (\blambda, \blambda^*)
		\right|_{\blambda=0}.
	\end{eqn*}
\end{lemma}
\begin{proof}
Mode operators with different indices commute, so
\begin{eqn}
	\chi_W (\blambda, \blambda^*)
	& = \Trace{
		\hat{\rho}
		\prod_{\nvec \in \restbasis}
			\exp( \lambda_{\nvec} \hat{a}_{\nvec}^\dagger - \lambda_{\nvec}^* \hat{a}_{\nvec})
	} \\
	& = \Trace{
		\hat{\rho}
		\prod_{\nvec \in \restbasis}
			\sum_{r_{\nvec} \in \restbasis, s_{\nvec} \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{r_{\nvec}} \lambda_{\nvec}^{s_{\nvec}}}{r_{\nvec}! s_{\nvec}!}
			\symprod{ \hat{a}_{\nvec}^{r_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{s_{\nvec}}}
	} \\
	& = \Trace{
		\hat{\rho}
		\left( \prod_{\nvec \in \restbasis} \sum_{r_{\nvec}, s_{\nvec}} \right)
		\left(
			\prod_{\nvec \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{r_{\nvec}} \lambda_{\nvec}^{s_{\nvec}}}{r_{\nvec}! s_{\nvec}!}
			\symprod{ \hat{a}_{\nvec}^{r_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{s_{\nvec}}}
		\right)
	} \\
	& = \Trace{
		\left( \prod_{\nvec \in \restbasis} \sum_{r_{\nvec}, s_{\nvec}} \right)
		\left(
			\prod_{\nvec \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{r_{\nvec}} \lambda_{\nvec}^{s_{\nvec}}}{r_{\nvec}! s_{\nvec}!}
		\right)
		\hat{\rho}
		\symprod{ \prod_{\nvec \in \restbasis} \hat{a}_{\nvec}^{r_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{s_{\nvec}}}
	} \\
	& = \left( \prod_{\nvec \in \restbasis} \sum_{r_{\nvec}, s_{\nvec}} \right)
		\left(
			\prod_{\nvec \in \restbasis}
			\frac{(-\lambda_{\nvec}^*)^{r_{\nvec}} \lambda_{\nvec}^{s_{\nvec}}}{r_{\nvec}! s_{\nvec}!}
		\right)
		\langle
			\symprod{ \prod_{\nvec \in \restbasis} \hat{a}_{\nvec}^{r_{\nvec}} (\hat{a}_{\nvec}^\dagger)^{s_{\nvec}}}
		\rangle.
\end{eqn}
Same as in \lmmref{formalism:sm-wigner:moments-from-chi}, differentiating the resulting expression will leave only term with required $r_{\nvec}$ and $s_{\nvec}$.
\end{proof}

Moments of multimode Wigner function correspond to the averages of symmetrically ordered products in the same way as for single-mode case.

\begin{theorem}[Multimode extension of \thmref{formalism:sm-wigner:moments}]
	\begin{eqn*}
		\int d^2\alpha_1 \ldots \int d^2\alpha_N\,
			\left(
				\prod_n \alpha_n^{r_n} (\alpha_n^*)^{s_n}
			\right) W(\balpha, \balpha^*)
		= \langle \symprod{ \prod_n \hat{a}_n^{r_n} (\hat{a}_n^\dagger)^{s_n} } \rangle.
	\end{eqn*}
\end{theorem}
\begin{proof}
The proof is carried out similarly to~\thmref{formalism:sm-wigner:moments}: integrals over $\alpha_n$ are eliminated one by one using \lmmref{c-numbers:fourier-of-moments}, resulting integrals over $\lambda_n$ are dealt with using integration by parts and \lmmref{c-numbers:zero-delta-integrals}, until we get the right part of~\lmmref{formalism:mm-wigner:moments-from-chi}.
\end{proof}
