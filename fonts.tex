\defaultfontfeatures{Ligatures=TeX, Numbers={OldStyle,Proportional},
  Scale=MatchLowercase, Mapping=tex-text, Contextuals=Swash}

\usepackage{libertine}
\renewcommand{\captionfont}{\rmfamily}

%\setmathfont[StylisticSet=1]{XITS Math Mod}
%\setmathfont{Asana Math}
\setmathfont{Tex Gyre Pagella Math}
\setmathfont[range={\mathcal,\mathbfcal},StylisticSet=1]{Latin Modern Math}

\DeclareMicrotypeSet{maintext}{family={LinLibertine}}
\UseMicrotypeSet[protrusion,expansion,tracking]{maintext}

% Fleurons (which most fonts do not have)
\newfontface{\fleurons}{JUnicode}
\newcommand{\vfleuron}{{\upshape\fleurons\symbol{\string"2766}}} % vertical
\newcommand{\hfleuron}{{\upshape\fleurons\symbol{\string"2767}}} % horizontal
